[rank: 0] Seed set to 42
Loading Data:   0%|          | 0/1849 [00:00<?, ?it/s]Loading Data: 100%|██████████| 1849/1849 [00:00<00:00, 62882.25it/s]
Loading Data:   0%|          | 0/276 [00:00<?, ?it/s]Loading Data: 100%|██████████| 276/276 [00:00<00:00, 63161.71it/s]
Loading Data:   0%|          | 0/537 [00:00<?, ?it/s]Loading Data: 100%|██████████| 537/537 [00:00<00:00, 64098.05it/s]
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
wandb: Currently logged in as: ayushsn (chiragjp). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/ays124/mimic/cardiomegaly/wandb/run-20240907_234504-wk9v48fm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run worthy-aardvark-79
wandb: ⭐️ View project at https://wandb.ai/chiragjp/mimic
wandb: 🚀 View run at https://wandb.ai/chiragjp/mimic/runs/wk9v48fm
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA L40S') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name  | Type     | Params | Mode 
-------------------------------------------
0 | model | DenseNet | 7.0 M  | train
-------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.820    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
#train:  1849
#val:    276
#test:   537
Optimal batch size found: 192

--- Fold 1/10 ---
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  2.36it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/9 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s] Epoch 0:  11%|█         | 1/9 [00:01<00:15,  0.50it/s]Epoch 0:  11%|█         | 1/9 [00:01<00:15,  0.50it/s, v_num=48fm]Epoch 0:  22%|██▏       | 2/9 [00:02<00:07,  0.90it/s, v_num=48fm]Epoch 0:  22%|██▏       | 2/9 [00:02<00:07,  0.90it/s, v_num=48fm]Epoch 0:  33%|███▎      | 3/9 [00:02<00:05,  1.11it/s, v_num=48fm]Epoch 0:  33%|███▎      | 3/9 [00:02<00:05,  1.11it/s, v_num=48fm]Epoch 0:  44%|████▍     | 4/9 [00:03<00:03,  1.27it/s, v_num=48fm]Epoch 0:  44%|████▍     | 4/9 [00:03<00:03,  1.27it/s, v_num=48fm]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.38it/s, v_num=48fm]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.38it/s, v_num=48fm]Epoch 0:  67%|██████▋   | 6/9 [00:04<00:02,  1.47it/s, v_num=48fm]Epoch 0:  67%|██████▋   | 6/9 [00:04<00:02,  1.47it/s, v_num=48fm]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.54it/s, v_num=48fm]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.54it/s, v_num=48fm]Epoch 0:  89%|████████▉ | 8/9 [00:05<00:00,  1.60it/s, v_num=48fm]Epoch 0:  89%|████████▉ | 8/9 [00:05<00:00,  1.60it/s, v_num=48fm]Epoch 0: 100%|██████████| 9/9 [00:05<00:00,  1.65it/s, v_num=48fm]Epoch 0: 100%|██████████| 9/9 [00:05<00:00,  1.64it/s, v_num=48fm]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 58.96it/s][A
Metric val_loss improved. New best score: 0.893
                                                                      [AEpoch 0: 100%|██████████| 9/9 [00:07<00:00,  1.26it/s, v_num=48fm]Epoch 0: 100%|██████████| 9/9 [00:07<00:00,  1.26it/s, v_num=48fm]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]        Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]Epoch 1:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=48fm]Epoch 1:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=48fm]Epoch 1:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=48fm]Epoch 1:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=48fm]Epoch 1:  33%|███▎      | 3/9 [00:02<00:05,  1.20it/s, v_num=48fm]Epoch 1:  33%|███▎      | 3/9 [00:02<00:05,  1.20it/s, v_num=48fm]Epoch 1:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=48fm]Epoch 1:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=48fm]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=48fm]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=48fm]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=48fm]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=48fm]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=48fm]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=48fm]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=48fm]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=48fm]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=48fm]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=48fm]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 75.20it/s][A
Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.867
                                                                      [AEpoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=48fm]Epoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=48fm]Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]        Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]Epoch 2:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=48fm]Epoch 2:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=48fm]Epoch 2:  22%|██▏       | 2/9 [00:02<00:07,  0.96it/s, v_num=48fm]Epoch 2:  22%|██▏       | 2/9 [00:02<00:07,  0.96it/s, v_num=48fm]Epoch 2:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=48fm]Epoch 2:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=48fm]Epoch 2:  44%|████▍     | 4/9 [00:03<00:03,  1.33it/s, v_num=48fm]Epoch 2:  44%|████▍     | 4/9 [00:03<00:03,  1.33it/s, v_num=48fm]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.44it/s, v_num=48fm]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.44it/s, v_num=48fm]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=48fm]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=48fm]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=48fm]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=48fm]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=48fm]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=48fm]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=48fm]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=48fm]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 72.19it/s][A
Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.844
                                                                      [AEpoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=48fm]Epoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=48fm]Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]        Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]Epoch 3:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=48fm]Epoch 3:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=48fm]Epoch 3:  22%|██▏       | 2/9 [00:01<00:06,  1.04it/s, v_num=48fm]Epoch 3:  22%|██▏       | 2/9 [00:01<00:06,  1.04it/s, v_num=48fm]Epoch 3:  33%|███▎      | 3/9 [00:02<00:04,  1.26it/s, v_num=48fm]Epoch 3:  33%|███▎      | 3/9 [00:02<00:04,  1.26it/s, v_num=48fm]Epoch 3:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=48fm]Epoch 3:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=48fm]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=48fm]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=48fm]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=48fm]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=48fm]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.66it/s, v_num=48fm]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.66it/s, v_num=48fm]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=48fm]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=48fm]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=48fm]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=48fm]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 55.36it/s][A
Metric val_loss improved by 0.284 >= min_delta = 0.0. New best score: 0.560
                                                                      [AEpoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=48fm]Epoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=48fm]Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]        Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]Epoch 4:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=48fm]Epoch 4:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=48fm]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=48fm]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=48fm]Epoch 4:  33%|███▎      | 3/9 [00:02<00:04,  1.20it/s, v_num=48fm]Epoch 4:  33%|███▎      | 3/9 [00:02<00:04,  1.20it/s, v_num=48fm]Epoch 4:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=48fm]Epoch 4:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=48fm]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=48fm]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=48fm]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=48fm]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=48fm]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=48fm]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=48fm]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=48fm]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=48fm]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=48fm]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=48fm]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 70.81it/s][A
                                                                      [AEpoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=48fm]Epoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=48fm]Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]        Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]Epoch 5:  11%|█         | 1/9 [00:01<00:11,  0.69it/s, v_num=48fm]Epoch 5:  11%|█         | 1/9 [00:01<00:11,  0.69it/s, v_num=48fm]Epoch 5:  22%|██▏       | 2/9 [00:01<00:06,  1.06it/s, v_num=48fm]Epoch 5:  22%|██▏       | 2/9 [00:01<00:06,  1.06it/s, v_num=48fm]Epoch 5:  33%|███▎      | 3/9 [00:02<00:04,  1.28it/s, v_num=48fm]Epoch 5:  33%|███▎      | 3/9 [00:02<00:04,  1.27it/s, v_num=48fm]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.42it/s, v_num=48fm]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.42it/s, v_num=48fm]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.53it/s, v_num=48fm]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.53it/s, v_num=48fm]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.61it/s, v_num=48fm]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.61it/s, v_num=48fm]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.67it/s, v_num=48fm]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.67it/s, v_num=48fm]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.72it/s, v_num=48fm]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.72it/s, v_num=48fm]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.79it/s, v_num=48fm]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.79it/s, v_num=48fm]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 72.38it/s][A
                                                                      [AEpoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=48fm]Epoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=48fm]Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]        Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]Epoch 6:  11%|█         | 1/9 [00:01<00:10,  0.73it/s, v_num=48fm]Epoch 6:  11%|█         | 1/9 [00:01<00:10,  0.73it/s, v_num=48fm]Epoch 6:  22%|██▏       | 2/9 [00:01<00:06,  1.09it/s, v_num=48fm]Epoch 6:  22%|██▏       | 2/9 [00:01<00:06,  1.09it/s, v_num=48fm]Epoch 6:  33%|███▎      | 3/9 [00:02<00:04,  1.31it/s, v_num=48fm]Epoch 6:  33%|███▎      | 3/9 [00:02<00:04,  1.31it/s, v_num=48fm]Epoch 6:  44%|████▍     | 4/9 [00:02<00:03,  1.46it/s, v_num=48fm]Epoch 6:  44%|████▍     | 4/9 [00:02<00:03,  1.46it/s, v_num=48fm]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.56it/s, v_num=48fm]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.56it/s, v_num=48fm]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.64it/s, v_num=48fm]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.64it/s, v_num=48fm]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.70it/s, v_num=48fm]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.70it/s, v_num=48fm]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.74it/s, v_num=48fm]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.74it/s, v_num=48fm]Epoch 6: 100%|██████████| 9/9 [00:04<00:00,  1.81it/s, v_num=48fm]Epoch 6: 100%|██████████| 9/9 [00:04<00:00,  1.81it/s, v_num=48fm]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 74.69it/s][A
                                                                      [AEpoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.41it/s, v_num=48fm]Epoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.41it/s, v_num=48fm]Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]        Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]Epoch 7:  11%|█         | 1/9 [00:01<00:11,  0.71it/s, v_num=48fm]Epoch 7:  11%|█         | 1/9 [00:01<00:11,  0.71it/s, v_num=48fm]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.07it/s, v_num=48fm]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.07it/s, v_num=48fm]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.30it/s, v_num=48fm]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.30it/s, v_num=48fm]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.45it/s, v_num=48fm]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.45it/s, v_num=48fm]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.55it/s, v_num=48fm]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.55it/s, v_num=48fm]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.63it/s, v_num=48fm]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.63it/s, v_num=48fm]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.69it/s, v_num=48fm]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.69it/s, v_num=48fm]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.74it/s, v_num=48fm]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.74it/s, v_num=48fm]Epoch 7: 100%|██████████| 9/9 [00:04<00:00,  1.81it/s, v_num=48fm]Epoch 7: 100%|██████████| 9/9 [00:04<00:00,  1.81it/s, v_num=48fm]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 71.18it/s][A
                                                                      [AEpoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.43it/s, v_num=48fm]Epoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.42it/s, v_num=48fm]Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]        Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=48fm]Epoch 8:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=48fm]Epoch 8:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=48fm]Epoch 8:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=48fm]Epoch 8:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=48fm]Epoch 8:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=48fm]Epoch 8:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=48fm]Epoch 8:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=48fm]Epoch 8:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=48fm]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=48fm]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=48fm]Epoch 8:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=48fm]Epoch 8:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=48fm]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=48fm]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=48fm]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=48fm]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=48fm]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=48fm]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=48fm]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 75.80it/s][A
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.560. Signaling Trainer to stop.
/home/ays124/mimic/venv/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
                                                                      [AEpoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=48fm]Epoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=48fm]Epoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=48fm]

VALIDATION for Fold 1
Test-loop:   0%|          | 0/1 [00:00<?, ?it/s]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.40s/it]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.44s/it]
Cardiomegaly AUC: 0.7083

TESTING for Fold 1
Test-loop:   0%|          | 0/3 [00:00<?, ?it/s]Test-loop:  33%|███▎      | 1/3 [00:01<00:02,  1.16s/it]Test-loop:  67%|██████▋   | 2/3 [00:01<00:00,  1.74it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.43it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  1.90it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.019 MB of 0.030 MB uploaded (0.003 MB deduped)wandb: | 0.019 MB of 0.030 MB uploaded (0.003 MB deduped)wandb: / 0.030 MB of 0.030 MB uploaded (0.003 MB deduped)wandb:                                                                                
wandb: W&B sync reduced upload amount by 11.2%
wandb: 
wandb: Run history:
wandb:                         epoch ▁▁▂▂▂▃▃▃▄▄▄▅▅▅▅▅▆▆▆▇▇▇███
wandb:               fold_1_test_auc ▁
wandb: fold_1_test_average precision ▁
wandb:                fold_1_test_f1 ▁
wandb:               fold_1_test_mcc ▁
wandb:               fold_1_test_npv ▁
wandb:               fold_1_test_ppv ▁
wandb:               fold_1_test_tnr ▁
wandb:               fold_1_test_tpr ▁
wandb:                fold_1_val_auc ▁
wandb:  fold_1_val_average precision ▁
wandb:                 fold_1_val_f1 ▁
wandb:                fold_1_val_mcc ▁
wandb:                fold_1_val_npv ▁
wandb:                fold_1_val_ppv ▁
wandb:                fold_1_val_tnr ▁
wandb:                fold_1_val_tpr ▁
wandb:                    train_loss ▄█▅▃▂▃▄▅▁▂▃▄▂▂▁▁
wandb:           trainer/global_step ▁▁▁▂▂▂▃▃▃▄▄▄▅▅▅▆▆▆▆▇▇▇▇█████████████████
wandb:                      val_loss █▇▇▁▃▃▂▃▁
wandb: 
wandb: Run summary:
wandb:                         epoch 8
wandb:               fold_1_test_auc 0.67704
wandb: fold_1_test_average precision 0.81703
wandb:                fold_1_test_f1 0.79805
wandb:               fold_1_test_mcc 0.16845
wandb:               fold_1_test_npv 0.46739
wandb:               fold_1_test_ppv 0.73708
wandb:               fold_1_test_tnr 0.26875
wandb:               fold_1_test_tpr 0.87003
wandb:                fold_1_val_auc 0.7083
wandb:  fold_1_val_average precision 0.81132
wandb:                 fold_1_val_f1 0.81404
wandb:                fold_1_val_mcc 0.29981
wandb:                fold_1_val_npv 0.72727
wandb:                fold_1_val_ppv 0.71166
wandb:                fold_1_val_tnr 0.25397
wandb:                fold_1_val_tpr 0.95082
wandb:                    train_loss 0.52523
wandb:           trainer/global_step 80
wandb:                      val_loss 0.56757
wandb: 
wandb: 🚀 View run worthy-aardvark-79 at: https://wandb.ai/chiragjp/mimic/runs/wk9v48fm
wandb: ⭐️ View project at: https://wandb.ai/chiragjp/mimic
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./cardiomegaly/wandb/run-20240907_234504-wk9v48fm/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/ays124/mimic/cardiomegaly/wandb/run-20240907_234622-wl7ch4sv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fresh-brook-80
wandb: ⭐️ View project at https://wandb.ai/chiragjp/mimic
wandb: 🚀 View run at https://wandb.ai/chiragjp/mimic/runs/wl7ch4sv
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name  | Type     | Params | Mode 
-------------------------------------------
0 | model | DenseNet | 7.0 M  | train
-------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.820    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Cardiomegaly AUC: 0.6770

--- Fold 2/10 ---
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 56.55it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/9 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s] Epoch 0:  11%|█         | 1/9 [00:01<00:11,  0.68it/s]Epoch 0:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=h4sv]Epoch 0:  22%|██▏       | 2/9 [00:01<00:06,  1.08it/s, v_num=h4sv]Epoch 0:  22%|██▏       | 2/9 [00:01<00:06,  1.08it/s, v_num=h4sv]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.30it/s, v_num=h4sv]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.30it/s, v_num=h4sv]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.45it/s, v_num=h4sv]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.45it/s, v_num=h4sv]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.55it/s, v_num=h4sv]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.55it/s, v_num=h4sv]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.63it/s, v_num=h4sv]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.63it/s, v_num=h4sv]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.69it/s, v_num=h4sv]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.69it/s, v_num=h4sv]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.74it/s, v_num=h4sv]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.74it/s, v_num=h4sv]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.81it/s, v_num=h4sv]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.81it/s, v_num=h4sv]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 66.22it/s][A
Metric val_loss improved. New best score: 0.580
                                                                      [AEpoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.41it/s, v_num=h4sv]Epoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.40it/s, v_num=h4sv]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]        Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]Epoch 1:  11%|█         | 1/9 [00:01<00:13,  0.60it/s, v_num=h4sv]Epoch 1:  11%|█         | 1/9 [00:01<00:13,  0.60it/s, v_num=h4sv]Epoch 1:  22%|██▏       | 2/9 [00:02<00:07,  0.94it/s, v_num=h4sv]Epoch 1:  22%|██▏       | 2/9 [00:02<00:07,  0.94it/s, v_num=h4sv]Epoch 1:  33%|███▎      | 3/9 [00:02<00:05,  1.16it/s, v_num=h4sv]Epoch 1:  33%|███▎      | 3/9 [00:02<00:05,  1.16it/s, v_num=h4sv]Epoch 1:  44%|████▍     | 4/9 [00:03<00:03,  1.31it/s, v_num=h4sv]Epoch 1:  44%|████▍     | 4/9 [00:03<00:03,  1.31it/s, v_num=h4sv]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.42it/s, v_num=h4sv]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.42it/s, v_num=h4sv]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.51it/s, v_num=h4sv]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.51it/s, v_num=h4sv]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=h4sv]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=h4sv]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=h4sv]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=h4sv]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=h4sv]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=h4sv]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 69.30it/s][A
                                                                      [AEpoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=h4sv]Epoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=h4sv]Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]        Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]Epoch 2:  11%|█         | 1/9 [00:01<00:11,  0.71it/s, v_num=h4sv]Epoch 2:  11%|█         | 1/9 [00:01<00:11,  0.71it/s, v_num=h4sv]Epoch 2:  22%|██▏       | 2/9 [00:01<00:06,  1.07it/s, v_num=h4sv]Epoch 2:  22%|██▏       | 2/9 [00:01<00:06,  1.07it/s, v_num=h4sv]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.28it/s, v_num=h4sv]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.28it/s, v_num=h4sv]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.43it/s, v_num=h4sv]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.43it/s, v_num=h4sv]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.54it/s, v_num=h4sv]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.54it/s, v_num=h4sv]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.61it/s, v_num=h4sv]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.61it/s, v_num=h4sv]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.67it/s, v_num=h4sv]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.67it/s, v_num=h4sv]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.72it/s, v_num=h4sv]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.72it/s, v_num=h4sv]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.79it/s, v_num=h4sv]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.79it/s, v_num=h4sv]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 68.54it/s][A
                                                                      [AEpoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=h4sv]Epoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=h4sv]Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]        Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]Epoch 3:  11%|█         | 1/9 [00:01<00:13,  0.58it/s, v_num=h4sv]Epoch 3:  11%|█         | 1/9 [00:01<00:13,  0.58it/s, v_num=h4sv]Epoch 3:  22%|██▏       | 2/9 [00:02<00:07,  0.92it/s, v_num=h4sv]Epoch 3:  22%|██▏       | 2/9 [00:02<00:07,  0.92it/s, v_num=h4sv]Epoch 3:  33%|███▎      | 3/9 [00:02<00:05,  1.14it/s, v_num=h4sv]Epoch 3:  33%|███▎      | 3/9 [00:02<00:05,  1.14it/s, v_num=h4sv]Epoch 3:  44%|████▍     | 4/9 [00:03<00:03,  1.29it/s, v_num=h4sv]Epoch 3:  44%|████▍     | 4/9 [00:03<00:03,  1.29it/s, v_num=h4sv]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.41it/s, v_num=h4sv]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.41it/s, v_num=h4sv]Epoch 3:  67%|██████▋   | 6/9 [00:04<00:02,  1.50it/s, v_num=h4sv]Epoch 3:  67%|██████▋   | 6/9 [00:04<00:02,  1.50it/s, v_num=h4sv]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.57it/s, v_num=h4sv]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.57it/s, v_num=h4sv]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.63it/s, v_num=h4sv]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.63it/s, v_num=h4sv]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.70it/s, v_num=h4sv]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.70it/s, v_num=h4sv]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 70.26it/s][A
                                                                      [AEpoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=h4sv]Epoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=h4sv]Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]        Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]Epoch 4:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=h4sv]Epoch 4:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=h4sv]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=h4sv]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=h4sv]Epoch 4:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=h4sv]Epoch 4:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=h4sv]Epoch 4:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=h4sv]Epoch 4:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=h4sv]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=h4sv]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=h4sv]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=h4sv]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=h4sv]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=h4sv]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=h4sv]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=h4sv]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=h4sv]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=h4sv]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=h4sv]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 68.67it/s][A
Metric val_loss improved by 0.041 >= min_delta = 0.0. New best score: 0.538
                                                                      [AEpoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=h4sv]Epoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=h4sv]Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]        Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]Epoch 5:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=h4sv]Epoch 5:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=h4sv]Epoch 5:  22%|██▏       | 2/9 [00:01<00:06,  1.04it/s, v_num=h4sv]Epoch 5:  22%|██▏       | 2/9 [00:01<00:06,  1.04it/s, v_num=h4sv]Epoch 5:  33%|███▎      | 3/9 [00:02<00:04,  1.26it/s, v_num=h4sv]Epoch 5:  33%|███▎      | 3/9 [00:02<00:04,  1.26it/s, v_num=h4sv]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.41it/s, v_num=h4sv]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.41it/s, v_num=h4sv]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=h4sv]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=h4sv]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=h4sv]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=h4sv]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=h4sv]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=h4sv]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=h4sv]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=h4sv]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=h4sv]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=h4sv]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 66.32it/s][A
                                                                      [AEpoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.40it/s, v_num=h4sv]Epoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=h4sv]Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]        Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]Epoch 6:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=h4sv]Epoch 6:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=h4sv]Epoch 6:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=h4sv]Epoch 6:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=h4sv]Epoch 6:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=h4sv]Epoch 6:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=h4sv]Epoch 6:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=h4sv]Epoch 6:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=h4sv]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=h4sv]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=h4sv]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=h4sv]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=h4sv]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=h4sv]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=h4sv]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=h4sv]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=h4sv]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=h4sv]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=h4sv]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 68.92it/s][A
                                                                      [AEpoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=h4sv]Epoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=h4sv]Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]        Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]Epoch 7:  11%|█         | 1/9 [00:01<00:11,  0.69it/s, v_num=h4sv]Epoch 7:  11%|█         | 1/9 [00:01<00:11,  0.69it/s, v_num=h4sv]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.04it/s, v_num=h4sv]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.04it/s, v_num=h4sv]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.26it/s, v_num=h4sv]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.26it/s, v_num=h4sv]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=h4sv]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=h4sv]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=h4sv]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=h4sv]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=h4sv]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=h4sv]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.66it/s, v_num=h4sv]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.66it/s, v_num=h4sv]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=h4sv]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=h4sv]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=h4sv]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=h4sv]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 73.39it/s][A
                                                                      [AEpoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=h4sv]Epoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=h4sv]Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]        Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]Epoch 8:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=h4sv]Epoch 8:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=h4sv]Epoch 8:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=h4sv]Epoch 8:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=h4sv]Epoch 8:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=h4sv]Epoch 8:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=h4sv]Epoch 8:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=h4sv]Epoch 8:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=h4sv]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=h4sv]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=h4sv]Epoch 8:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=h4sv]Epoch 8:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=h4sv]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=h4sv]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=h4sv]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=h4sv]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=h4sv]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=h4sv]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=h4sv]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 67.08it/s][A
                                                                      [AEpoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=h4sv]Epoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=h4sv]Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]        Epoch 9:   0%|          | 0/9 [00:00<?, ?it/s, v_num=h4sv]Epoch 9:  11%|█         | 1/9 [00:01<00:12,  0.62it/s, v_num=h4sv]Epoch 9:  11%|█         | 1/9 [00:01<00:12,  0.62it/s, v_num=h4sv]Epoch 9:  22%|██▏       | 2/9 [00:02<00:07,  0.97it/s, v_num=h4sv]Epoch 9:  22%|██▏       | 2/9 [00:02<00:07,  0.97it/s, v_num=h4sv]Epoch 9:  33%|███▎      | 3/9 [00:02<00:05,  1.18it/s, v_num=h4sv]Epoch 9:  33%|███▎      | 3/9 [00:02<00:05,  1.18it/s, v_num=h4sv]Epoch 9:  44%|████▍     | 4/9 [00:02<00:03,  1.34it/s, v_num=h4sv]Epoch 9:  44%|████▍     | 4/9 [00:02<00:03,  1.33it/s, v_num=h4sv]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=h4sv]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=h4sv]Epoch 9:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=h4sv]Epoch 9:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=h4sv]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.60it/s, v_num=h4sv]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.60it/s, v_num=h4sv]Epoch 9:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=h4sv]Epoch 9:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=h4sv]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=h4sv]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=h4sv]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 69.76it/s][A
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.538. Signaling Trainer to stop.
/home/ays124/mimic/venv/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
                                                                      [AEpoch 9: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=h4sv]Epoch 9: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=h4sv]Epoch 9: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=h4sv]

VALIDATION for Fold 2
Test-loop:   0%|          | 0/1 [00:00<?, ?it/s]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.15s/it]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.18s/it]
Cardiomegaly AUC: 0.6599

TESTING for Fold 2
Test-loop:   0%|          | 0/3 [00:00<?, ?it/s]Test-loop:  33%|███▎      | 1/3 [00:01<00:02,  1.03s/it]Test-loop:  67%|██████▋   | 2/3 [00:01<00:00,  1.92it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.82it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.13it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.030 MB of 0.030 MB uploaded (0.003 MB deduped)wandb:                                                                                
wandb: W&B sync reduced upload amount by 11.3%
wandb: 
wandb: Run history:
wandb:                         epoch ▁▁▂▂▂▃▃▃▃▃▃▄▄▄▅▅▆▆▆▆▆▆▇▇▇███
wandb:               fold_2_test_auc ▁
wandb: fold_2_test_average precision ▁
wandb:                fold_2_test_f1 ▁
wandb:               fold_2_test_mcc ▁
wandb:               fold_2_test_npv ▁
wandb:               fold_2_test_ppv ▁
wandb:               fold_2_test_tnr ▁
wandb:               fold_2_test_tpr ▁
wandb:                fold_2_val_auc ▁
wandb:  fold_2_val_average precision ▁
wandb:                 fold_2_val_f1 ▁
wandb:                fold_2_val_mcc ▁
wandb:                fold_2_val_npv ▁
wandb:                fold_2_val_ppv ▁
wandb:                fold_2_val_tnr ▁
wandb:                fold_2_val_tpr ▁
wandb:                    train_loss ▇▆▄▅▄█▅▄▅▆▂▂▁▃▂▄▂▂
wandb:           trainer/global_step ▁▁▁▂▂▂▃▃▃▃▄▄▄▅▅▅▆▆▆▆▇▇▇█████████████████
wandb:                      val_loss ▂█▃▂▁▃▂▂▁▃
wandb: 
wandb: Run summary:
wandb:                         epoch 9
wandb:               fold_2_test_auc 0.67401
wandb: fold_2_test_average precision 0.82344
wandb:                fold_2_test_f1 0.79554
wandb:               fold_2_test_mcc 0.19489
wandb:               fold_2_test_npv 0.47664
wandb:               fold_2_test_ppv 0.74651
wandb:               fold_2_test_tnr 0.31875
wandb:               fold_2_test_tpr 0.85146
wandb:                fold_2_val_auc 0.65994
wandb:  fold_2_val_average precision 0.82927
wandb:                 fold_2_val_f1 0.77818
wandb:                fold_2_val_mcc 0.13837
wandb:                fold_2_val_npv 0.38636
wandb:                fold_2_val_ppv 0.75887
wandb:                fold_2_val_tnr 0.33333
wandb:                fold_2_val_tpr 0.79851
wandb:                    train_loss 0.51255
wandb:           trainer/global_step 89
wandb:                      val_loss 0.63203
wandb: 
wandb: 🚀 View run fresh-brook-80 at: https://wandb.ai/chiragjp/mimic/runs/wl7ch4sv
wandb: ⭐️ View project at: https://wandb.ai/chiragjp/mimic
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./cardiomegaly/wandb/run-20240907_234622-wl7ch4sv/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/ays124/mimic/cardiomegaly/wandb/run-20240907_234741-xg4ls2m5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run crimson-armadillo-81
wandb: ⭐️ View project at https://wandb.ai/chiragjp/mimic
wandb: 🚀 View run at https://wandb.ai/chiragjp/mimic/runs/xg4ls2m5
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name  | Type     | Params | Mode 
-------------------------------------------
0 | model | DenseNet | 7.0 M  | train
-------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.820    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Cardiomegaly AUC: 0.6740

--- Fold 3/10 ---
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 54.41it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/9 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s] Epoch 0:  11%|█         | 1/9 [00:01<00:11,  0.73it/s]Epoch 0:  11%|█         | 1/9 [00:01<00:11,  0.73it/s, v_num=s2m5]Epoch 0:  22%|██▏       | 2/9 [00:01<00:06,  1.14it/s, v_num=s2m5]Epoch 0:  22%|██▏       | 2/9 [00:01<00:06,  1.14it/s, v_num=s2m5]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.35it/s, v_num=s2m5]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.35it/s, v_num=s2m5]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.50it/s, v_num=s2m5]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.50it/s, v_num=s2m5]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.60it/s, v_num=s2m5]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.60it/s, v_num=s2m5]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.67it/s, v_num=s2m5]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.67it/s, v_num=s2m5]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.73it/s, v_num=s2m5]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.73it/s, v_num=s2m5]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.77it/s, v_num=s2m5]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.77it/s, v_num=s2m5]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.84it/s, v_num=s2m5]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.84it/s, v_num=s2m5]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 64.87it/s][A
Metric val_loss improved. New best score: 2.116
                                                                      [AEpoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.42it/s, v_num=s2m5]Epoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.41it/s, v_num=s2m5]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]        Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]Epoch 1:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=s2m5]Epoch 1:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=s2m5]Epoch 1:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=s2m5]Epoch 1:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=s2m5]Epoch 1:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=s2m5]Epoch 1:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=s2m5]Epoch 1:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=s2m5]Epoch 1:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=s2m5]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=s2m5]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=s2m5]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=s2m5]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=s2m5]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=s2m5]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=s2m5]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=s2m5]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=s2m5]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=s2m5]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=s2m5]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 66.44it/s][A
Metric val_loss improved by 1.414 >= min_delta = 0.0. New best score: 0.703
                                                                      [AEpoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=s2m5]Epoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=s2m5]Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]        Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=s2m5]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=s2m5]Epoch 2:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=s2m5]Epoch 2:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=s2m5]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.20it/s, v_num=s2m5]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.20it/s, v_num=s2m5]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=s2m5]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=s2m5]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=s2m5]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=s2m5]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=s2m5]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=s2m5]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=s2m5]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=s2m5]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=s2m5]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=s2m5]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=s2m5]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=s2m5]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 63.61it/s][A
Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.660
                                                                      [AEpoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=s2m5]Epoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=s2m5]Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]        Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]Epoch 3:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=s2m5]Epoch 3:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=s2m5]Epoch 3:  22%|██▏       | 2/9 [00:01<00:06,  1.02it/s, v_num=s2m5]Epoch 3:  22%|██▏       | 2/9 [00:01<00:06,  1.02it/s, v_num=s2m5]Epoch 3:  33%|███▎      | 3/9 [00:02<00:04,  1.24it/s, v_num=s2m5]Epoch 3:  33%|███▎      | 3/9 [00:02<00:04,  1.24it/s, v_num=s2m5]Epoch 3:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=s2m5]Epoch 3:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=s2m5]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=s2m5]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=s2m5]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=s2m5]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=s2m5]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=s2m5]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=s2m5]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=s2m5]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=s2m5]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=s2m5]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=s2m5]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 65.11it/s][A
Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.637
                                                                      [AEpoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=s2m5]Epoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=s2m5]Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]        Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]Epoch 4:  11%|█         | 1/9 [00:01<00:14,  0.55it/s, v_num=s2m5]Epoch 4:  11%|█         | 1/9 [00:01<00:14,  0.55it/s, v_num=s2m5]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.88it/s, v_num=s2m5]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.88it/s, v_num=s2m5]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.10it/s, v_num=s2m5]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.10it/s, v_num=s2m5]Epoch 4:  44%|████▍     | 4/9 [00:03<00:03,  1.25it/s, v_num=s2m5]Epoch 4:  44%|████▍     | 4/9 [00:03<00:03,  1.25it/s, v_num=s2m5]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.37it/s, v_num=s2m5]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.36it/s, v_num=s2m5]Epoch 4:  67%|██████▋   | 6/9 [00:04<00:02,  1.45it/s, v_num=s2m5]Epoch 4:  67%|██████▋   | 6/9 [00:04<00:02,  1.45it/s, v_num=s2m5]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.52it/s, v_num=s2m5]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.52it/s, v_num=s2m5]Epoch 4:  89%|████████▉ | 8/9 [00:05<00:00,  1.58it/s, v_num=s2m5]Epoch 4:  89%|████████▉ | 8/9 [00:05<00:00,  1.58it/s, v_num=s2m5]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.66it/s, v_num=s2m5]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.66it/s, v_num=s2m5]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 62.83it/s][A
                                                                      [AEpoch 4: 100%|██████████| 9/9 [00:07<00:00,  1.27it/s, v_num=s2m5]Epoch 4: 100%|██████████| 9/9 [00:07<00:00,  1.27it/s, v_num=s2m5]Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]        Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]Epoch 5:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=s2m5]Epoch 5:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=s2m5]Epoch 5:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=s2m5]Epoch 5:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=s2m5]Epoch 5:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=s2m5]Epoch 5:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=s2m5]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=s2m5]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=s2m5]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=s2m5]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=s2m5]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=s2m5]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=s2m5]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=s2m5]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=s2m5]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=s2m5]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=s2m5]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=s2m5]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=s2m5]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 57.78it/s][A
                                                                      [AEpoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=s2m5]Epoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=s2m5]Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]        Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]Epoch 6:  11%|█         | 1/9 [00:01<00:13,  0.62it/s, v_num=s2m5]Epoch 6:  11%|█         | 1/9 [00:01<00:13,  0.62it/s, v_num=s2m5]Epoch 6:  22%|██▏       | 2/9 [00:02<00:07,  0.96it/s, v_num=s2m5]Epoch 6:  22%|██▏       | 2/9 [00:02<00:07,  0.96it/s, v_num=s2m5]Epoch 6:  33%|███▎      | 3/9 [00:02<00:05,  1.18it/s, v_num=s2m5]Epoch 6:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=s2m5]Epoch 6:  44%|████▍     | 4/9 [00:03<00:03,  1.32it/s, v_num=s2m5]Epoch 6:  44%|████▍     | 4/9 [00:03<00:03,  1.32it/s, v_num=s2m5]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.44it/s, v_num=s2m5]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.44it/s, v_num=s2m5]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.52it/s, v_num=s2m5]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.52it/s, v_num=s2m5]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=s2m5]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=s2m5]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=s2m5]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=s2m5]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=s2m5]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=s2m5]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 65.53it/s][A
                                                                      [AEpoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=s2m5]Epoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=s2m5]Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]        Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]Epoch 7:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=s2m5]Epoch 7:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=s2m5]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=s2m5]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=s2m5]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=s2m5]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=s2m5]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=s2m5]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=s2m5]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=s2m5]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=s2m5]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=s2m5]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=s2m5]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=s2m5]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=s2m5]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=s2m5]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=s2m5]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=s2m5]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=s2m5]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 55.00it/s][A
                                                                      [AEpoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=s2m5]Epoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=s2m5]Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]        Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=s2m5]Epoch 8:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=s2m5]Epoch 8:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=s2m5]Epoch 8:  22%|██▏       | 2/9 [00:02<00:07,  0.97it/s, v_num=s2m5]Epoch 8:  22%|██▏       | 2/9 [00:02<00:07,  0.97it/s, v_num=s2m5]Epoch 8:  33%|███▎      | 3/9 [00:02<00:05,  1.19it/s, v_num=s2m5]Epoch 8:  33%|███▎      | 3/9 [00:02<00:05,  1.19it/s, v_num=s2m5]Epoch 8:  44%|████▍     | 4/9 [00:03<00:03,  1.33it/s, v_num=s2m5]Epoch 8:  44%|████▍     | 4/9 [00:03<00:03,  1.33it/s, v_num=s2m5]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=s2m5]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=s2m5]Epoch 8:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=s2m5]Epoch 8:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=s2m5]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.60it/s, v_num=s2m5]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.60it/s, v_num=s2m5]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=s2m5]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=s2m5]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=s2m5]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=s2m5]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 66.10it/s][A
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.637. Signaling Trainer to stop.
/home/ays124/mimic/venv/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
                                                                      [AEpoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=s2m5]Epoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=s2m5]Epoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=s2m5]

VALIDATION for Fold 3
Test-loop:   0%|          | 0/1 [00:00<?, ?it/s]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.27s/it]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.30s/it]
Cardiomegaly AUC: 0.5963

TESTING for Fold 3
Test-loop:   0%|          | 0/3 [00:00<?, ?it/s]Test-loop:  33%|███▎      | 1/3 [00:00<00:01,  1.02it/s]Test-loop:  67%|██████▋   | 2/3 [00:01<00:00,  1.99it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.90it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.22it/s]
wandb: - 0.029 MB of 0.029 MB uploaded (0.003 MB deduped)wandb:                                                                                
wandb: W&B sync reduced upload amount by 11.6%
wandb: 
wandb: Run history:
wandb:                         epoch ▁▁▂▂▂▃▃▃▄▄▄▅▅▅▅▅▆▆▆▇▇▇███
wandb:               fold_3_test_auc ▁
wandb: fold_3_test_average precision ▁
wandb:                fold_3_test_f1 ▁
wandb:               fold_3_test_mcc ▁
wandb:               fold_3_test_npv ▁
wandb:               fold_3_test_ppv ▁
wandb:               fold_3_test_tnr ▁
wandb:               fold_3_test_tpr ▁
wandb:                fold_3_val_auc ▁
wandb:  fold_3_val_average precision ▁
wandb:                 fold_3_val_f1 ▁
wandb:                fold_3_val_mcc ▁
wandb:                fold_3_val_npv ▁
wandb:                fold_3_val_ppv ▁
wandb:                fold_3_val_tnr ▁
wandb:                fold_3_val_tpr ▁
wandb:                    train_loss █▇▄▇▄▄▅▄█▄▃▄▅▃▁▅
wandb:           trainer/global_step ▁▁▁▂▂▂▃▃▃▄▄▄▅▅▅▆▆▆▆▇▇▇▇█████████████████
wandb:                      val_loss █▁▁▁▁▁▁▁▂
wandb: 
wandb: Run summary:
wandb:                         epoch 8
wandb:               fold_3_test_auc 0.67401
wandb: fold_3_test_average precision 0.81172
wandb:                fold_3_test_f1 0.77131
wandb:               fold_3_test_mcc 0.26807
wandb:               fold_3_test_npv 0.47429
wandb:               fold_3_test_ppv 0.78729
wandb:               fold_3_test_tnr 0.51875
wandb:               fold_3_test_tpr 0.75597
wandb:                fold_3_val_auc 0.59628
wandb:  fold_3_val_average precision 0.74107
wandb:                 fold_3_val_f1 0.76364
wandb:                fold_3_val_mcc 0.13699
wandb:                fold_3_val_npv 0.5
wandb:                fold_3_val_ppv 0.67742
wandb:                fold_3_val_tnr 0.23077
wandb:                fold_3_val_tpr 0.875
wandb:                    train_loss 0.59323
wandb:           trainer/global_step 80
wandb:                      val_loss 0.81018
wandb: 
wandb: 🚀 View run crimson-armadillo-81 at: https://wandb.ai/chiragjp/mimic/runs/xg4ls2m5
wandb: ⭐️ View project at: https://wandb.ai/chiragjp/mimic
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./cardiomegaly/wandb/run-20240907_234741-xg4ls2m5/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/ays124/mimic/cardiomegaly/wandb/run-20240907_234855-t7v7qkgk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dandy-deluge-82
wandb: ⭐️ View project at https://wandb.ai/chiragjp/mimic
wandb: 🚀 View run at https://wandb.ai/chiragjp/mimic/runs/t7v7qkgk
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name  | Type     | Params | Mode 
-------------------------------------------
0 | model | DenseNet | 7.0 M  | train
-------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.820    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Cardiomegaly AUC: 0.6740

--- Fold 4/10 ---
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 47.60it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/9 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s] Epoch 0:  11%|█         | 1/9 [00:01<00:11,  0.69it/s]Epoch 0:  11%|█         | 1/9 [00:01<00:11,  0.69it/s, v_num=qkgk]Epoch 0:  22%|██▏       | 2/9 [00:01<00:06,  1.10it/s, v_num=qkgk]Epoch 0:  22%|██▏       | 2/9 [00:01<00:06,  1.10it/s, v_num=qkgk]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.32it/s, v_num=qkgk]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.32it/s, v_num=qkgk]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.46it/s, v_num=qkgk]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.46it/s, v_num=qkgk]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.56it/s, v_num=qkgk]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.56it/s, v_num=qkgk]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.64it/s, v_num=qkgk]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.64it/s, v_num=qkgk]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.70it/s, v_num=qkgk]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.70it/s, v_num=qkgk]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.75it/s, v_num=qkgk]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.75it/s, v_num=qkgk]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.82it/s, v_num=qkgk]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.82it/s, v_num=qkgk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 64.96it/s][A
Metric val_loss improved. New best score: 0.549
                                                                      [AEpoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=qkgk]Epoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=qkgk]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s, v_num=qkgk]        Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=qkgk]Epoch 1:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=qkgk]Epoch 1:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=qkgk]Epoch 1:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=qkgk]Epoch 1:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=qkgk]Epoch 1:  33%|███▎      | 3/9 [00:02<00:04,  1.24it/s, v_num=qkgk]Epoch 1:  33%|███▎      | 3/9 [00:02<00:04,  1.24it/s, v_num=qkgk]Epoch 1:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=qkgk]Epoch 1:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=qkgk]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=qkgk]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=qkgk]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=qkgk]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=qkgk]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=qkgk]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=qkgk]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=qkgk]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=qkgk]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=qkgk]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=qkgk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 58.91it/s][A
                                                                      [AEpoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=qkgk]Epoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=qkgk]Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=qkgk]        Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=qkgk]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=qkgk]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=qkgk]Epoch 2:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=qkgk]Epoch 2:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=qkgk]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=qkgk]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=qkgk]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.37it/s, v_num=qkgk]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.37it/s, v_num=qkgk]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=qkgk]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=qkgk]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=qkgk]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=qkgk]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=qkgk]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=qkgk]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=qkgk]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=qkgk]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=qkgk]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=qkgk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 59.94it/s][A
                                                                      [AEpoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=qkgk]Epoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=qkgk]Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=qkgk]        Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=qkgk]Epoch 3:  11%|█         | 1/9 [00:01<00:12,  0.62it/s, v_num=qkgk]Epoch 3:  11%|█         | 1/9 [00:01<00:12,  0.62it/s, v_num=qkgk]Epoch 3:  22%|██▏       | 2/9 [00:02<00:07,  0.97it/s, v_num=qkgk]Epoch 3:  22%|██▏       | 2/9 [00:02<00:07,  0.97it/s, v_num=qkgk]Epoch 3:  33%|███▎      | 3/9 [00:02<00:05,  1.19it/s, v_num=qkgk]Epoch 3:  33%|███▎      | 3/9 [00:02<00:05,  1.19it/s, v_num=qkgk]Epoch 3:  44%|████▍     | 4/9 [00:02<00:03,  1.33it/s, v_num=qkgk]Epoch 3:  44%|████▍     | 4/9 [00:03<00:03,  1.33it/s, v_num=qkgk]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.44it/s, v_num=qkgk]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.44it/s, v_num=qkgk]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=qkgk]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=qkgk]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=qkgk]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=qkgk]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=qkgk]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=qkgk]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=qkgk]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=qkgk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.17it/s][A
                                                                      [AEpoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=qkgk]Epoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=qkgk]Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=qkgk]        Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=qkgk]Epoch 4:  11%|█         | 1/9 [00:01<00:13,  0.58it/s, v_num=qkgk]Epoch 4:  11%|█         | 1/9 [00:01<00:13,  0.58it/s, v_num=qkgk]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.92it/s, v_num=qkgk]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.92it/s, v_num=qkgk]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.14it/s, v_num=qkgk]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.14it/s, v_num=qkgk]Epoch 4:  44%|████▍     | 4/9 [00:03<00:03,  1.29it/s, v_num=qkgk]Epoch 4:  44%|████▍     | 4/9 [00:03<00:03,  1.29it/s, v_num=qkgk]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.41it/s, v_num=qkgk]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.41it/s, v_num=qkgk]Epoch 4:  67%|██████▋   | 6/9 [00:04<00:02,  1.50it/s, v_num=qkgk]Epoch 4:  67%|██████▋   | 6/9 [00:04<00:02,  1.50it/s, v_num=qkgk]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.57it/s, v_num=qkgk]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.57it/s, v_num=qkgk]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.62it/s, v_num=qkgk]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.62it/s, v_num=qkgk]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.69it/s, v_num=qkgk]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.69it/s, v_num=qkgk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 64.44it/s][A
                                                                      [AEpoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.30it/s, v_num=qkgk]Epoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.30it/s, v_num=qkgk]Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=qkgk]        Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=qkgk]Epoch 5:  11%|█         | 1/9 [00:01<00:12,  0.62it/s, v_num=qkgk]Epoch 5:  11%|█         | 1/9 [00:01<00:12,  0.62it/s, v_num=qkgk]Epoch 5:  22%|██▏       | 2/9 [00:02<00:07,  0.96it/s, v_num=qkgk]Epoch 5:  22%|██▏       | 2/9 [00:02<00:07,  0.96it/s, v_num=qkgk]Epoch 5:  33%|███▎      | 3/9 [00:02<00:05,  1.18it/s, v_num=qkgk]Epoch 5:  33%|███▎      | 3/9 [00:02<00:05,  1.18it/s, v_num=qkgk]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.34it/s, v_num=qkgk]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.34it/s, v_num=qkgk]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=qkgk]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=qkgk]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=qkgk]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=qkgk]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=qkgk]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=qkgk]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=qkgk]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=qkgk]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=qkgk]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=qkgk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 59.67it/s][A
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.549. Signaling Trainer to stop.
/home/ays124/mimic/venv/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
                                                                      [AEpoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=qkgk]Epoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=qkgk]Epoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=qkgk]

VALIDATION for Fold 4
Test-loop:   0%|          | 0/1 [00:00<?, ?it/s]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.17s/it]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.21s/it]
Cardiomegaly AUC: 0.5141

TESTING for Fold 4
Test-loop:   0%|          | 0/3 [00:00<?, ?it/s]Test-loop:  33%|███▎      | 1/3 [00:00<00:01,  1.01it/s]Test-loop:  67%|██████▋   | 2/3 [00:01<00:00,  1.98it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.89it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.22it/s]
wandb: - 0.019 MB of 0.029 MB uploaded (0.003 MB deduped)wandb: \ 0.019 MB of 0.029 MB uploaded (0.003 MB deduped)wandb: | 0.029 MB of 0.029 MB uploaded (0.003 MB deduped)wandb:                                                                                
wandb: W&B sync reduced upload amount by 11.4%
wandb: 
wandb: Run history:
wandb:                         epoch ▁▁▂▂▂▄▄▄▅▅▅▇▇▇██
wandb:               fold_4_test_auc ▁
wandb: fold_4_test_average precision ▁
wandb:                fold_4_test_f1 ▁
wandb:               fold_4_test_mcc ▁
wandb:               fold_4_test_npv ▁
wandb:               fold_4_test_ppv ▁
wandb:               fold_4_test_tnr ▁
wandb:               fold_4_test_tpr ▁
wandb:                fold_4_val_auc ▁
wandb:  fold_4_val_average precision ▁
wandb:                 fold_4_val_f1 ▁
wandb:                fold_4_val_mcc ▁
wandb:                fold_4_val_npv ▁
wandb:                fold_4_val_ppv ▁
wandb:                fold_4_val_tnr ▁
wandb:                fold_4_val_tpr ▁
wandb:                    train_loss █▇▂▇▅▅▄▅▃▁
wandb:           trainer/global_step ▁▂▂▂▃▃▄▄▅▅▅▆▇▇▇█████████████████
wandb:                      val_loss ▁█▃▄▂▂
wandb: 
wandb: Run summary:
wandb:                         epoch 5
wandb:               fold_4_test_auc 0.63224
wandb: fold_4_test_average precision 0.81211
wandb:                fold_4_test_f1 0.82495
wandb:               fold_4_test_mcc 0.0
wandb:               fold_4_test_npv 0
wandb:               fold_4_test_ppv 0.70205
wandb:               fold_4_test_tnr 0.0
wandb:               fold_4_test_tpr 1.0
wandb:                fold_4_val_auc 0.51408
wandb:  fold_4_val_average precision 0.78612
wandb:                 fold_4_val_f1 0.8685
wandb:                fold_4_val_mcc 0.0
wandb:                fold_4_val_npv 0
wandb:                fold_4_val_ppv 0.76757
wandb:                fold_4_val_tnr 0.0
wandb:                fold_4_val_tpr 1.0
wandb:                    train_loss 0.54369
wandb:           trainer/global_step 53
wandb:                      val_loss 0.58315
wandb: 
wandb: 🚀 View run dandy-deluge-82 at: https://wandb.ai/chiragjp/mimic/runs/t7v7qkgk
wandb: ⭐️ View project at: https://wandb.ai/chiragjp/mimic
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./cardiomegaly/wandb/run-20240907_234855-t7v7qkgk/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/ays124/mimic/cardiomegaly/wandb/run-20240907_234949-orkblvvk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deep-capybara-83
wandb: ⭐️ View project at https://wandb.ai/chiragjp/mimic
wandb: 🚀 View run at https://wandb.ai/chiragjp/mimic/runs/orkblvvk
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name  | Type     | Params | Mode 
-------------------------------------------
0 | model | DenseNet | 7.0 M  | train
-------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.820    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Cardiomegaly AUC: 0.6322

--- Fold 5/10 ---
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 52.58it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/9 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s] Epoch 0:  11%|█         | 1/9 [00:01<00:10,  0.79it/s]Epoch 0:  11%|█         | 1/9 [00:01<00:10,  0.79it/s, v_num=lvvk]Epoch 0:  22%|██▏       | 2/9 [00:01<00:05,  1.22it/s, v_num=lvvk]Epoch 0:  22%|██▏       | 2/9 [00:01<00:05,  1.22it/s, v_num=lvvk]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.43it/s, v_num=lvvk]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.42it/s, v_num=lvvk]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.57it/s, v_num=lvvk]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.57it/s, v_num=lvvk]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.66it/s, v_num=lvvk]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.66it/s, v_num=lvvk]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.73it/s, v_num=lvvk]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.73it/s, v_num=lvvk]Epoch 0:  78%|███████▊  | 7/9 [00:03<00:01,  1.78it/s, v_num=lvvk]Epoch 0:  78%|███████▊  | 7/9 [00:03<00:01,  1.78it/s, v_num=lvvk]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.82it/s, v_num=lvvk]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.82it/s, v_num=lvvk]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.89it/s, v_num=lvvk]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.89it/s, v_num=lvvk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 64.13it/s][A
Metric val_loss improved. New best score: 6.535
                                                                      [AEpoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.49it/s, v_num=lvvk]Epoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.49it/s, v_num=lvvk]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]        Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]Epoch 1:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=lvvk]Epoch 1:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=lvvk]Epoch 1:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=lvvk]Epoch 1:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=lvvk]Epoch 1:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=lvvk]Epoch 1:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=lvvk]Epoch 1:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=lvvk]Epoch 1:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=lvvk]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=lvvk]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=lvvk]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=lvvk]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=lvvk]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=lvvk]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=lvvk]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=lvvk]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=lvvk]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=lvvk]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=lvvk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.78it/s][A
Metric val_loss improved by 5.907 >= min_delta = 0.0. New best score: 0.628
                                                                      [AEpoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=lvvk]Epoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=lvvk]Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]        Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=lvvk]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=lvvk]Epoch 2:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=lvvk]Epoch 2:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=lvvk]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=lvvk]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=lvvk]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=lvvk]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=lvvk]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=lvvk]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=lvvk]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=lvvk]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=lvvk]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=lvvk]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=lvvk]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=lvvk]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=lvvk]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=lvvk]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=lvvk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 60.29it/s][A
                                                                      [AEpoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=lvvk]Epoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=lvvk]Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]        Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]Epoch 3:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=lvvk]Epoch 3:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=lvvk]Epoch 3:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=lvvk]Epoch 3:  22%|██▏       | 2/9 [00:01<00:06,  1.00it/s, v_num=lvvk]Epoch 3:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=lvvk]Epoch 3:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=lvvk]Epoch 3:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=lvvk]Epoch 3:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=lvvk]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=lvvk]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=lvvk]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=lvvk]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=lvvk]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=lvvk]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=lvvk]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=lvvk]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=lvvk]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=lvvk]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=lvvk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.39it/s][A
                                                                      [AEpoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=lvvk]Epoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=lvvk]Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]        Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]Epoch 4:  11%|█         | 1/9 [00:01<00:13,  0.59it/s, v_num=lvvk]Epoch 4:  11%|█         | 1/9 [00:01<00:13,  0.59it/s, v_num=lvvk]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.94it/s, v_num=lvvk]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.94it/s, v_num=lvvk]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.15it/s, v_num=lvvk]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.15it/s, v_num=lvvk]Epoch 4:  44%|████▍     | 4/9 [00:03<00:03,  1.31it/s, v_num=lvvk]Epoch 4:  44%|████▍     | 4/9 [00:03<00:03,  1.31it/s, v_num=lvvk]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.42it/s, v_num=lvvk]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.42it/s, v_num=lvvk]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.50it/s, v_num=lvvk]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.50it/s, v_num=lvvk]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.57it/s, v_num=lvvk]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.57it/s, v_num=lvvk]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.63it/s, v_num=lvvk]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.63it/s, v_num=lvvk]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.70it/s, v_num=lvvk]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.70it/s, v_num=lvvk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 56.28it/s][A
                                                                      [AEpoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=lvvk]Epoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=lvvk]Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]        Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]Epoch 5:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=lvvk]Epoch 5:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=lvvk]Epoch 5:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=lvvk]Epoch 5:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=lvvk]Epoch 5:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=lvvk]Epoch 5:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=lvvk]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=lvvk]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=lvvk]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=lvvk]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=lvvk]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=lvvk]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=lvvk]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=lvvk]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=lvvk]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=lvvk]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=lvvk]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=lvvk]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=lvvk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 57.54it/s][A
Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.607
                                                                      [AEpoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=lvvk]Epoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=lvvk]Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]        Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]Epoch 6:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=lvvk]Epoch 6:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=lvvk]Epoch 6:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=lvvk]Epoch 6:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=lvvk]Epoch 6:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=lvvk]Epoch 6:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=lvvk]Epoch 6:  44%|████▍     | 4/9 [00:03<00:03,  1.33it/s, v_num=lvvk]Epoch 6:  44%|████▍     | 4/9 [00:03<00:03,  1.33it/s, v_num=lvvk]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.44it/s, v_num=lvvk]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.44it/s, v_num=lvvk]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=lvvk]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=lvvk]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=lvvk]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=lvvk]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=lvvk]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=lvvk]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=lvvk]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=lvvk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 60.72it/s][A
                                                                      [AEpoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=lvvk]Epoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=lvvk]Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]        Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]Epoch 7:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=lvvk]Epoch 7:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=lvvk]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=lvvk]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=lvvk]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.24it/s, v_num=lvvk]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.24it/s, v_num=lvvk]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=lvvk]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=lvvk]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=lvvk]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=lvvk]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=lvvk]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=lvvk]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=lvvk]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=lvvk]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=lvvk]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=lvvk]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=lvvk]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=lvvk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 58.89it/s][A
Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.597
                                                                      [AEpoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=lvvk]Epoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=lvvk]Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]        Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]Epoch 8:  11%|█         | 1/9 [00:01<00:13,  0.58it/s, v_num=lvvk]Epoch 8:  11%|█         | 1/9 [00:01<00:13,  0.58it/s, v_num=lvvk]Epoch 8:  22%|██▏       | 2/9 [00:02<00:07,  0.92it/s, v_num=lvvk]Epoch 8:  22%|██▏       | 2/9 [00:02<00:07,  0.92it/s, v_num=lvvk]Epoch 8:  33%|███▎      | 3/9 [00:02<00:05,  1.14it/s, v_num=lvvk]Epoch 8:  33%|███▎      | 3/9 [00:02<00:05,  1.14it/s, v_num=lvvk]Epoch 8:  44%|████▍     | 4/9 [00:03<00:03,  1.29it/s, v_num=lvvk]Epoch 8:  44%|████▍     | 4/9 [00:03<00:03,  1.29it/s, v_num=lvvk]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.40it/s, v_num=lvvk]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.40it/s, v_num=lvvk]Epoch 8:  67%|██████▋   | 6/9 [00:04<00:02,  1.49it/s, v_num=lvvk]Epoch 8:  67%|██████▋   | 6/9 [00:04<00:02,  1.49it/s, v_num=lvvk]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.56it/s, v_num=lvvk]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.56it/s, v_num=lvvk]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.61it/s, v_num=lvvk]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.61it/s, v_num=lvvk]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.68it/s, v_num=lvvk]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.68it/s, v_num=lvvk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 58.70it/s][A
                                                                      [AEpoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=lvvk]Epoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=lvvk]Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]        Epoch 9:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]Epoch 9:  11%|█         | 1/9 [00:01<00:11,  0.72it/s, v_num=lvvk]Epoch 9:  11%|█         | 1/9 [00:01<00:11,  0.72it/s, v_num=lvvk]Epoch 9:  22%|██▏       | 2/9 [00:01<00:06,  1.09it/s, v_num=lvvk]Epoch 9:  22%|██▏       | 2/9 [00:01<00:06,  1.09it/s, v_num=lvvk]Epoch 9:  33%|███▎      | 3/9 [00:02<00:04,  1.30it/s, v_num=lvvk]Epoch 9:  33%|███▎      | 3/9 [00:02<00:04,  1.30it/s, v_num=lvvk]Epoch 9:  44%|████▍     | 4/9 [00:02<00:03,  1.44it/s, v_num=lvvk]Epoch 9:  44%|████▍     | 4/9 [00:02<00:03,  1.44it/s, v_num=lvvk]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.54it/s, v_num=lvvk]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.54it/s, v_num=lvvk]Epoch 9:  67%|██████▋   | 6/9 [00:03<00:01,  1.62it/s, v_num=lvvk]Epoch 9:  67%|██████▋   | 6/9 [00:03<00:01,  1.62it/s, v_num=lvvk]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.68it/s, v_num=lvvk]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.68it/s, v_num=lvvk]Epoch 9:  89%|████████▉ | 8/9 [00:04<00:00,  1.73it/s, v_num=lvvk]Epoch 9:  89%|████████▉ | 8/9 [00:04<00:00,  1.73it/s, v_num=lvvk]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.80it/s, v_num=lvvk]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.80it/s, v_num=lvvk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 59.97it/s][A
                                                                      [AEpoch 9: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=lvvk]Epoch 9: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=lvvk]Epoch 9:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]        Epoch 10:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]Epoch 10:  11%|█         | 1/9 [00:01<00:10,  0.76it/s, v_num=lvvk]Epoch 10:  11%|█         | 1/9 [00:01<00:10,  0.76it/s, v_num=lvvk]Epoch 10:  22%|██▏       | 2/9 [00:01<00:06,  1.12it/s, v_num=lvvk]Epoch 10:  22%|██▏       | 2/9 [00:01<00:06,  1.12it/s, v_num=lvvk]Epoch 10:  33%|███▎      | 3/9 [00:02<00:04,  1.34it/s, v_num=lvvk]Epoch 10:  33%|███▎      | 3/9 [00:02<00:04,  1.34it/s, v_num=lvvk]Epoch 10:  44%|████▍     | 4/9 [00:02<00:03,  1.48it/s, v_num=lvvk]Epoch 10:  44%|████▍     | 4/9 [00:02<00:03,  1.48it/s, v_num=lvvk]Epoch 10:  56%|█████▌    | 5/9 [00:03<00:02,  1.58it/s, v_num=lvvk]Epoch 10:  56%|█████▌    | 5/9 [00:03<00:02,  1.58it/s, v_num=lvvk]Epoch 10:  67%|██████▋   | 6/9 [00:03<00:01,  1.65it/s, v_num=lvvk]Epoch 10:  67%|██████▋   | 6/9 [00:03<00:01,  1.65it/s, v_num=lvvk]Epoch 10:  78%|███████▊  | 7/9 [00:04<00:01,  1.71it/s, v_num=lvvk]Epoch 10:  78%|███████▊  | 7/9 [00:04<00:01,  1.71it/s, v_num=lvvk]Epoch 10:  89%|████████▉ | 8/9 [00:04<00:00,  1.75it/s, v_num=lvvk]Epoch 10:  89%|████████▉ | 8/9 [00:04<00:00,  1.75it/s, v_num=lvvk]Epoch 10: 100%|██████████| 9/9 [00:04<00:00,  1.82it/s, v_num=lvvk]Epoch 10: 100%|██████████| 9/9 [00:04<00:00,  1.82it/s, v_num=lvvk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 52.84it/s][A
                                                                      [AEpoch 10: 100%|██████████| 9/9 [00:06<00:00,  1.41it/s, v_num=lvvk]Epoch 10: 100%|██████████| 9/9 [00:06<00:00,  1.41it/s, v_num=lvvk]Epoch 10:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]        Epoch 11:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]Epoch 11:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=lvvk]Epoch 11:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=lvvk]Epoch 11:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=lvvk]Epoch 11:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=lvvk]Epoch 11:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=lvvk]Epoch 11:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=lvvk]Epoch 11:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=lvvk]Epoch 11:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=lvvk]Epoch 11:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=lvvk]Epoch 11:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=lvvk]Epoch 11:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=lvvk]Epoch 11:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=lvvk]Epoch 11:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=lvvk]Epoch 11:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=lvvk]Epoch 11:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=lvvk]Epoch 11:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=lvvk]Epoch 11: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=lvvk]Epoch 11: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=lvvk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 48.87it/s][A
                                                                      [AEpoch 11: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=lvvk]Epoch 11: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=lvvk]Epoch 11:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]        Epoch 12:   0%|          | 0/9 [00:00<?, ?it/s, v_num=lvvk]Epoch 12:  11%|█         | 1/9 [00:01<00:11,  0.69it/s, v_num=lvvk]Epoch 12:  11%|█         | 1/9 [00:01<00:11,  0.69it/s, v_num=lvvk]Epoch 12:  22%|██▏       | 2/9 [00:01<00:06,  1.05it/s, v_num=lvvk]Epoch 12:  22%|██▏       | 2/9 [00:01<00:06,  1.04it/s, v_num=lvvk]Epoch 12:  33%|███▎      | 3/9 [00:02<00:04,  1.26it/s, v_num=lvvk]Epoch 12:  33%|███▎      | 3/9 [00:02<00:04,  1.26it/s, v_num=lvvk]Epoch 12:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=lvvk]Epoch 12:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=lvvk]Epoch 12:  56%|█████▌    | 5/9 [00:03<00:02,  1.37it/s, v_num=lvvk]Epoch 12:  56%|█████▌    | 5/9 [00:03<00:02,  1.37it/s, v_num=lvvk]Epoch 12:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=lvvk]Epoch 12:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=lvvk]Epoch 12:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=lvvk]Epoch 12:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=lvvk]Epoch 12:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=lvvk]Epoch 12:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=lvvk]Epoch 12: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=lvvk]Epoch 12: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=lvvk]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 60.13it/s][A
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.597. Signaling Trainer to stop.
/home/ays124/mimic/venv/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
                                                                      [AEpoch 12: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=lvvk]Epoch 12: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=lvvk]Epoch 12: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=lvvk]

VALIDATION for Fold 5
Test-loop:   0%|          | 0/1 [00:00<?, ?it/s]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.26s/it]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.30s/it]
Cardiomegaly AUC: 0.6713

TESTING for Fold 5
Test-loop:   0%|          | 0/3 [00:00<?, ?it/s]Test-loop:  33%|███▎      | 1/3 [00:00<00:01,  1.04it/s]Test-loop:  67%|██████▋   | 2/3 [00:01<00:00,  1.82it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.72it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.11it/s]
wandb: - 0.029 MB of 0.029 MB uploaded (0.003 MB deduped)wandb:                                                                                
wandb: W&B sync reduced upload amount by 11.6%
wandb: 
wandb: Run history:
wandb:                         epoch ▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:               fold_5_test_auc ▁
wandb: fold_5_test_average precision ▁
wandb:                fold_5_test_f1 ▁
wandb:               fold_5_test_mcc ▁
wandb:               fold_5_test_npv ▁
wandb:               fold_5_test_ppv ▁
wandb:               fold_5_test_tnr ▁
wandb:               fold_5_test_tpr ▁
wandb:                fold_5_val_auc ▁
wandb:  fold_5_val_average precision ▁
wandb:                 fold_5_val_f1 ▁
wandb:                fold_5_val_mcc ▁
wandb:                fold_5_val_npv ▁
wandb:                fold_5_val_ppv ▁
wandb:                fold_5_val_tnr ▁
wandb:                fold_5_val_tpr ▁
wandb:                    train_loss █▅▅▃▄▃▂▃▄▂▁▃▃▂▂▂▃▃▃▂▁▁▂
wandb:           trainer/global_step ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▅▅▅▅▆▆▆▆▇▇▇▇██████████████
wandb:                      val_loss █▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:                         epoch 12
wandb:               fold_5_test_auc 0.6626
wandb: fold_5_test_average precision 0.82185
wandb:                fold_5_test_f1 0.7903
wandb:               fold_5_test_mcc 0.12573
wandb:               fold_5_test_npv 0.42697
wandb:               fold_5_test_ppv 0.72768
wandb:               fold_5_test_tnr 0.2375
wandb:               fold_5_test_tpr 0.86472
wandb:                fold_5_val_auc 0.67133
wandb:  fold_5_val_average precision 0.80511
wandb:                 fold_5_val_f1 0.81333
wandb:                fold_5_val_mcc 0.11007
wandb:                fold_5_val_npv 0.46667
wandb:                fold_5_val_ppv 0.71765
wandb:                fold_5_val_tnr 0.12727
wandb:                fold_5_val_tpr 0.93846
wandb:                    train_loss 0.49384
wandb:           trainer/global_step 116
wandb:                      val_loss 0.72245
wandb: 
wandb: 🚀 View run deep-capybara-83 at: https://wandb.ai/chiragjp/mimic/runs/orkblvvk
wandb: ⭐️ View project at: https://wandb.ai/chiragjp/mimic
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./cardiomegaly/wandb/run-20240907_234949-orkblvvk/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/ays124/mimic/cardiomegaly/wandb/run-20240907_235129-7ocznqer
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run revived-rain-84
wandb: ⭐️ View project at https://wandb.ai/chiragjp/mimic
wandb: 🚀 View run at https://wandb.ai/chiragjp/mimic/runs/7ocznqer
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name  | Type     | Params | Mode 
-------------------------------------------
0 | model | DenseNet | 7.0 M  | train
-------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.820    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Cardiomegaly AUC: 0.6626

--- Fold 6/10 ---
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 47.50it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/9 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s] Epoch 0:  11%|█         | 1/9 [00:01<00:11,  0.68it/s]Epoch 0:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=nqer]Epoch 0:  22%|██▏       | 2/9 [00:01<00:06,  1.08it/s, v_num=nqer]Epoch 0:  22%|██▏       | 2/9 [00:01<00:06,  1.08it/s, v_num=nqer]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.29it/s, v_num=nqer]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.29it/s, v_num=nqer]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.44it/s, v_num=nqer]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.44it/s, v_num=nqer]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.54it/s, v_num=nqer]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.54it/s, v_num=nqer]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.62it/s, v_num=nqer]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.62it/s, v_num=nqer]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.68it/s, v_num=nqer]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.68it/s, v_num=nqer]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.73it/s, v_num=nqer]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.73it/s, v_num=nqer]Epoch 0: 100%|██████████| 9/9 [00:05<00:00,  1.80it/s, v_num=nqer]Epoch 0: 100%|██████████| 9/9 [00:05<00:00,  1.80it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.70it/s][A
Metric val_loss improved. New best score: 0.677
                                                                      [AEpoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=nqer]Epoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=nqer]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 1:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=nqer]Epoch 1:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=nqer]Epoch 1:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=nqer]Epoch 1:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=nqer]Epoch 1:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=nqer]Epoch 1:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=nqer]Epoch 1:  44%|████▍     | 4/9 [00:03<00:03,  1.32it/s, v_num=nqer]Epoch 1:  44%|████▍     | 4/9 [00:03<00:03,  1.32it/s, v_num=nqer]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=nqer]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=nqer]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.52it/s, v_num=nqer]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.52it/s, v_num=nqer]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=nqer]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=nqer]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=nqer]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=nqer]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=nqer]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.97it/s][A
                                                                      [AEpoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=nqer]Epoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=nqer]Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 2:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=nqer]Epoch 2:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=nqer]Epoch 2:  22%|██▏       | 2/9 [00:01<00:06,  1.04it/s, v_num=nqer]Epoch 2:  22%|██▏       | 2/9 [00:01<00:06,  1.04it/s, v_num=nqer]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.26it/s, v_num=nqer]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.26it/s, v_num=nqer]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=nqer]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=nqer]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=nqer]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=nqer]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=nqer]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=nqer]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=nqer]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=nqer]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=nqer]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=nqer]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=nqer]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.56it/s][A
                                                                      [AEpoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=nqer]Epoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=nqer]Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 3:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=nqer]Epoch 3:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=nqer]Epoch 3:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=nqer]Epoch 3:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=nqer]Epoch 3:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=nqer]Epoch 3:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=nqer]Epoch 3:  44%|████▍     | 4/9 [00:03<00:03,  1.31it/s, v_num=nqer]Epoch 3:  44%|████▍     | 4/9 [00:03<00:03,  1.31it/s, v_num=nqer]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=nqer]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=nqer]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.51it/s, v_num=nqer]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.51it/s, v_num=nqer]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=nqer]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=nqer]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=nqer]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=nqer]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=nqer]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 54.13it/s][A
                                                                      [AEpoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=nqer]Epoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=nqer]Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 4:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=nqer]Epoch 4:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=nqer]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=nqer]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=nqer]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.20it/s, v_num=nqer]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.20it/s, v_num=nqer]Epoch 4:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=nqer]Epoch 4:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=nqer]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=nqer]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=nqer]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=nqer]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=nqer]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=nqer]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=nqer]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=nqer]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=nqer]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=nqer]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 62.47it/s][A
Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.657
                                                                      [AEpoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=nqer]Epoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=nqer]Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 5:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=nqer]Epoch 5:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=nqer]Epoch 5:  22%|██▏       | 2/9 [00:01<00:06,  1.04it/s, v_num=nqer]Epoch 5:  22%|██▏       | 2/9 [00:01<00:06,  1.04it/s, v_num=nqer]Epoch 5:  33%|███▎      | 3/9 [00:02<00:04,  1.26it/s, v_num=nqer]Epoch 5:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=nqer]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=nqer]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=nqer]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=nqer]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=nqer]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=nqer]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=nqer]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=nqer]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=nqer]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=nqer]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=nqer]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=nqer]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 63.27it/s][A
Metric val_loss improved by 0.051 >= min_delta = 0.0. New best score: 0.607
                                                                      [AEpoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=nqer]Epoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=nqer]Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 6:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=nqer]Epoch 6:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=nqer]Epoch 6:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=nqer]Epoch 6:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=nqer]Epoch 6:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=nqer]Epoch 6:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=nqer]Epoch 6:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=nqer]Epoch 6:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=nqer]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=nqer]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=nqer]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=nqer]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=nqer]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=nqer]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=nqer]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=nqer]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=nqer]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=nqer]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 55.12it/s][A
                                                                      [AEpoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=nqer]Epoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=nqer]Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 7:  11%|█         | 1/9 [00:01<00:11,  0.71it/s, v_num=nqer]Epoch 7:  11%|█         | 1/9 [00:01<00:11,  0.71it/s, v_num=nqer]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.07it/s, v_num=nqer]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.07it/s, v_num=nqer]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.28it/s, v_num=nqer]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.28it/s, v_num=nqer]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.43it/s, v_num=nqer]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.43it/s, v_num=nqer]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.54it/s, v_num=nqer]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.54it/s, v_num=nqer]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.62it/s, v_num=nqer]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.62it/s, v_num=nqer]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.68it/s, v_num=nqer]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.68it/s, v_num=nqer]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.73it/s, v_num=nqer]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.73it/s, v_num=nqer]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.80it/s, v_num=nqer]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.80it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 62.27it/s][A
                                                                      [AEpoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.40it/s, v_num=nqer]Epoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=nqer]Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 8:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=nqer]Epoch 8:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=nqer]Epoch 8:  22%|██▏       | 2/9 [00:01<00:06,  1.00it/s, v_num=nqer]Epoch 8:  22%|██▏       | 2/9 [00:01<00:06,  1.00it/s, v_num=nqer]Epoch 8:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=nqer]Epoch 8:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=nqer]Epoch 8:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=nqer]Epoch 8:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=nqer]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=nqer]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=nqer]Epoch 8:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=nqer]Epoch 8:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=nqer]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=nqer]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=nqer]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=nqer]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=nqer]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=nqer]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 63.67it/s][A
                                                                      [AEpoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=nqer]Epoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=nqer]Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 9:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 9:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=nqer]Epoch 9:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=nqer]Epoch 9:  22%|██▏       | 2/9 [00:01<00:06,  1.02it/s, v_num=nqer]Epoch 9:  22%|██▏       | 2/9 [00:01<00:06,  1.02it/s, v_num=nqer]Epoch 9:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=nqer]Epoch 9:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=nqer]Epoch 9:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=nqer]Epoch 9:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=nqer]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=nqer]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=nqer]Epoch 9:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=nqer]Epoch 9:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=nqer]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=nqer]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=nqer]Epoch 9:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=nqer]Epoch 9:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=nqer]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=nqer]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 63.88it/s][A
Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.584
                                                                      [AEpoch 9: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=nqer]Epoch 9: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=nqer]Epoch 9:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 10:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 10:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=nqer]Epoch 10:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=nqer]Epoch 10:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=nqer]Epoch 10:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=nqer]Epoch 10:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=nqer]Epoch 10:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=nqer]Epoch 10:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=nqer]Epoch 10:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=nqer]Epoch 10:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=nqer]Epoch 10:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=nqer]Epoch 10:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=nqer]Epoch 10:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=nqer]Epoch 10:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=nqer]Epoch 10:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=nqer]Epoch 10:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=nqer]Epoch 10:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=nqer]Epoch 10: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=nqer]Epoch 10: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 62.01it/s][A
                                                                      [AEpoch 10: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=nqer]Epoch 10: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=nqer]Epoch 10:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 11:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 11:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=nqer]Epoch 11:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=nqer]Epoch 11:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=nqer]Epoch 11:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=nqer]Epoch 11:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=nqer]Epoch 11:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=nqer]Epoch 11:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=nqer]Epoch 11:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=nqer]Epoch 11:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=nqer]Epoch 11:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=nqer]Epoch 11:  67%|██████▋   | 6/9 [00:03<00:01,  1.56it/s, v_num=nqer]Epoch 11:  67%|██████▋   | 6/9 [00:03<00:01,  1.56it/s, v_num=nqer]Epoch 11:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=nqer]Epoch 11:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=nqer]Epoch 11:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=nqer]Epoch 11:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=nqer]Epoch 11: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=nqer]Epoch 11: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 65.58it/s][A
                                                                      [AEpoch 11: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=nqer]Epoch 11: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=nqer]Epoch 11:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 12:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 12:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=nqer]Epoch 12:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=nqer]Epoch 12:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=nqer]Epoch 12:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=nqer]Epoch 12:  33%|███▎      | 3/9 [00:02<00:05,  1.19it/s, v_num=nqer]Epoch 12:  33%|███▎      | 3/9 [00:02<00:05,  1.19it/s, v_num=nqer]Epoch 12:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=nqer]Epoch 12:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=nqer]Epoch 12:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=nqer]Epoch 12:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=nqer]Epoch 12:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=nqer]Epoch 12:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=nqer]Epoch 12:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=nqer]Epoch 12:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=nqer]Epoch 12:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=nqer]Epoch 12:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=nqer]Epoch 12: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=nqer]Epoch 12: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 63.32it/s][A
                                                                      [AEpoch 12: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=nqer]Epoch 12: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=nqer]Epoch 12:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 13:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 13:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=nqer]Epoch 13:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=nqer]Epoch 13:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=nqer]Epoch 13:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=nqer]Epoch 13:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=nqer]Epoch 13:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=nqer]Epoch 13:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=nqer]Epoch 13:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=nqer]Epoch 13:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=nqer]Epoch 13:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=nqer]Epoch 13:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=nqer]Epoch 13:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=nqer]Epoch 13:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=nqer]Epoch 13:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=nqer]Epoch 13:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=nqer]Epoch 13:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=nqer]Epoch 13: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=nqer]Epoch 13: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 62.91it/s][A
                                                                      [AEpoch 13: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=nqer]Epoch 13: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=nqer]Epoch 13:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]        Epoch 14:   0%|          | 0/9 [00:00<?, ?it/s, v_num=nqer]Epoch 14:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=nqer]Epoch 14:  11%|█         | 1/9 [00:01<00:12,  0.67it/s, v_num=nqer]Epoch 14:  22%|██▏       | 2/9 [00:01<00:06,  1.02it/s, v_num=nqer]Epoch 14:  22%|██▏       | 2/9 [00:01<00:06,  1.02it/s, v_num=nqer]Epoch 14:  33%|███▎      | 3/9 [00:02<00:04,  1.24it/s, v_num=nqer]Epoch 14:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=nqer]Epoch 14:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=nqer]Epoch 14:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=nqer]Epoch 14:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=nqer]Epoch 14:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=nqer]Epoch 14:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=nqer]Epoch 14:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=nqer]Epoch 14:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=nqer]Epoch 14:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=nqer]Epoch 14:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=nqer]Epoch 14:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=nqer]Epoch 14: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=nqer]Epoch 14: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=nqer]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.39it/s][A
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.584. Signaling Trainer to stop.
/home/ays124/mimic/venv/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
                                                                      [AEpoch 14: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=nqer]Epoch 14: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=nqer]Epoch 14: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=nqer]

VALIDATION for Fold 6
Test-loop:   0%|          | 0/1 [00:00<?, ?it/s]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.18s/it]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it]
Cardiomegaly AUC: 0.7073

TESTING for Fold 6
Test-loop:   0%|          | 0/3 [00:00<?, ?it/s]Test-loop:  33%|███▎      | 1/3 [00:01<00:02,  1.04s/it]Test-loop:  67%|██████▋   | 2/3 [00:01<00:00,  1.90it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.82it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.14it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.019 MB of 0.026 MB uploaded (0.003 MB deduped)wandb: | 0.019 MB of 0.026 MB uploaded (0.003 MB deduped)wandb: / 0.030 MB of 0.030 MB uploaded (0.003 MB deduped)wandb:                                                                                
wandb: W&B sync reduced upload amount by 11.1%
wandb: 
wandb: Run history:
wandb:                         epoch ▁▁▁▁▁▂▂▂▃▃▃▃▃▃▃▃▄▄▄▅▅▅▅▅▅▅▅▆▆▇▇▇▇▇▇▇▇▇██
wandb:               fold_6_test_auc ▁
wandb: fold_6_test_average precision ▁
wandb:                fold_6_test_f1 ▁
wandb:               fold_6_test_mcc ▁
wandb:               fold_6_test_npv ▁
wandb:               fold_6_test_ppv ▁
wandb:               fold_6_test_tnr ▁
wandb:               fold_6_test_tpr ▁
wandb:                fold_6_val_auc ▁
wandb:  fold_6_val_average precision ▁
wandb:                 fold_6_val_f1 ▁
wandb:                fold_6_val_mcc ▁
wandb:                fold_6_val_npv ▁
wandb:                fold_6_val_ppv ▁
wandb:                fold_6_val_tnr ▁
wandb:                fold_6_val_tpr ▁
wandb:                    train_loss █▅▅▅▆▆▅▆▄▄▅▃▅▅▄▄▃▅▃▄▃▂▃▃▃▂▁
wandb:           trainer/global_step ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▅▅▅▅▆▆▆▆▇▇▇▇██████████████
wandb:                      val_loss ▃█▃▄▃▁▂▆▃▁▂▆▂▃▃
wandb: 
wandb: Run summary:
wandb:                         epoch 14
wandb:               fold_6_test_auc 0.69302
wandb: fold_6_test_average precision 0.82557
wandb:                fold_6_test_f1 0.8128
wandb:               fold_6_test_mcc 0.18313
wandb:               fold_6_test_npv 0.51429
wandb:               fold_6_test_ppv 0.73448
wandb:               fold_6_test_tnr 0.225
wandb:               fold_6_test_tpr 0.90981
wandb:                fold_6_val_auc 0.70729
wandb:  fold_6_val_average precision 0.8249
wandb:                 fold_6_val_f1 0.8069
wandb:                fold_6_val_mcc 0.19388
wandb:                fold_6_val_npv 0.57143
wandb:                fold_6_val_ppv 0.71341
wandb:                fold_6_val_tnr 0.20339
wandb:                fold_6_val_tpr 0.92857
wandb:                    train_loss 0.3988
wandb:           trainer/global_step 134
wandb:                      val_loss 0.68686
wandb: 
wandb: 🚀 View run revived-rain-84 at: https://wandb.ai/chiragjp/mimic/runs/7ocznqer
wandb: ⭐️ View project at: https://wandb.ai/chiragjp/mimic
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./cardiomegaly/wandb/run-20240907_235129-7ocznqer/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/ays124/mimic/cardiomegaly/wandb/run-20240907_235322-74i0npzj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run amber-wood-85
wandb: ⭐️ View project at https://wandb.ai/chiragjp/mimic
wandb: 🚀 View run at https://wandb.ai/chiragjp/mimic/runs/74i0npzj
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name  | Type     | Params | Mode 
-------------------------------------------
0 | model | DenseNet | 7.0 M  | train
-------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.820    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Cardiomegaly AUC: 0.6930

--- Fold 7/10 ---
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 54.18it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/9 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s] Epoch 0:  11%|█         | 1/9 [00:01<00:10,  0.75it/s]Epoch 0:  11%|█         | 1/9 [00:01<00:10,  0.75it/s, v_num=npzj]Epoch 0:  22%|██▏       | 2/9 [00:01<00:06,  1.16it/s, v_num=npzj]Epoch 0:  22%|██▏       | 2/9 [00:01<00:06,  1.16it/s, v_num=npzj]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.37it/s, v_num=npzj]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.37it/s, v_num=npzj]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.51it/s, v_num=npzj]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.51it/s, v_num=npzj]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.60it/s, v_num=npzj]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.60it/s, v_num=npzj]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.68it/s, v_num=npzj]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.68it/s, v_num=npzj]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.73it/s, v_num=npzj]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.73it/s, v_num=npzj]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.78it/s, v_num=npzj]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.78it/s, v_num=npzj]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.84it/s, v_num=npzj]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.84it/s, v_num=npzj]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 57.47it/s][A
Metric val_loss improved. New best score: 1.281
                                                                      [AEpoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=npzj]Epoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=npzj]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]        Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]Epoch 1:  11%|█         | 1/9 [00:01<00:13,  0.60it/s, v_num=npzj]Epoch 1:  11%|█         | 1/9 [00:01<00:13,  0.60it/s, v_num=npzj]Epoch 1:  22%|██▏       | 2/9 [00:02<00:07,  0.94it/s, v_num=npzj]Epoch 1:  22%|██▏       | 2/9 [00:02<00:07,  0.94it/s, v_num=npzj]Epoch 1:  33%|███▎      | 3/9 [00:02<00:05,  1.16it/s, v_num=npzj]Epoch 1:  33%|███▎      | 3/9 [00:02<00:05,  1.16it/s, v_num=npzj]Epoch 1:  44%|████▍     | 4/9 [00:03<00:03,  1.31it/s, v_num=npzj]Epoch 1:  44%|████▍     | 4/9 [00:03<00:03,  1.31it/s, v_num=npzj]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=npzj]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=npzj]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.52it/s, v_num=npzj]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.52it/s, v_num=npzj]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=npzj]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=npzj]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=npzj]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=npzj]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=npzj]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=npzj]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 60.09it/s][A
Metric val_loss improved by 0.403 >= min_delta = 0.0. New best score: 0.878
                                                                      [AEpoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=npzj]Epoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=npzj]Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]        Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.62it/s, v_num=npzj]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.62it/s, v_num=npzj]Epoch 2:  22%|██▏       | 2/9 [00:02<00:07,  0.97it/s, v_num=npzj]Epoch 2:  22%|██▏       | 2/9 [00:02<00:07,  0.97it/s, v_num=npzj]Epoch 2:  33%|███▎      | 3/9 [00:02<00:05,  1.18it/s, v_num=npzj]Epoch 2:  33%|███▎      | 3/9 [00:02<00:05,  1.18it/s, v_num=npzj]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.34it/s, v_num=npzj]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.34it/s, v_num=npzj]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=npzj]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=npzj]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=npzj]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=npzj]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.60it/s, v_num=npzj]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.60it/s, v_num=npzj]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=npzj]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=npzj]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=npzj]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=npzj]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 56.03it/s][A
Metric val_loss improved by 0.085 >= min_delta = 0.0. New best score: 0.793
                                                                      [AEpoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=npzj]Epoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=npzj]Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]        Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]Epoch 3:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=npzj]Epoch 3:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=npzj]Epoch 3:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=npzj]Epoch 3:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=npzj]Epoch 3:  33%|███▎      | 3/9 [00:02<00:04,  1.20it/s, v_num=npzj]Epoch 3:  33%|███▎      | 3/9 [00:02<00:04,  1.20it/s, v_num=npzj]Epoch 3:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=npzj]Epoch 3:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=npzj]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=npzj]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=npzj]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=npzj]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=npzj]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=npzj]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=npzj]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=npzj]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=npzj]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=npzj]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=npzj]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 59.04it/s][A
Metric val_loss improved by 0.134 >= min_delta = 0.0. New best score: 0.659
                                                                      [AEpoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=npzj]Epoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=npzj]Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]        Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]Epoch 4:  11%|█         | 1/9 [00:01<00:14,  0.57it/s, v_num=npzj]Epoch 4:  11%|█         | 1/9 [00:01<00:14,  0.57it/s, v_num=npzj]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.90it/s, v_num=npzj]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.90it/s, v_num=npzj]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.11it/s, v_num=npzj]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.11it/s, v_num=npzj]Epoch 4:  44%|████▍     | 4/9 [00:03<00:03,  1.27it/s, v_num=npzj]Epoch 4:  44%|████▍     | 4/9 [00:03<00:03,  1.27it/s, v_num=npzj]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.38it/s, v_num=npzj]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.38it/s, v_num=npzj]Epoch 4:  67%|██████▋   | 6/9 [00:04<00:02,  1.47it/s, v_num=npzj]Epoch 4:  67%|██████▋   | 6/9 [00:04<00:02,  1.47it/s, v_num=npzj]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.54it/s, v_num=npzj]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.54it/s, v_num=npzj]Epoch 4:  89%|████████▉ | 8/9 [00:05<00:00,  1.60it/s, v_num=npzj]Epoch 4:  89%|████████▉ | 8/9 [00:05<00:00,  1.60it/s, v_num=npzj]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.67it/s, v_num=npzj]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.67it/s, v_num=npzj]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.07it/s][A
Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.639
                                                                      [AEpoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.31it/s, v_num=npzj]Epoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.31it/s, v_num=npzj]Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]        Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]Epoch 5:  11%|█         | 1/9 [00:01<00:14,  0.56it/s, v_num=npzj]Epoch 5:  11%|█         | 1/9 [00:01<00:14,  0.55it/s, v_num=npzj]Epoch 5:  22%|██▏       | 2/9 [00:02<00:07,  0.88it/s, v_num=npzj]Epoch 5:  22%|██▏       | 2/9 [00:02<00:07,  0.88it/s, v_num=npzj]Epoch 5:  33%|███▎      | 3/9 [00:02<00:05,  1.11it/s, v_num=npzj]Epoch 5:  33%|███▎      | 3/9 [00:02<00:05,  1.11it/s, v_num=npzj]Epoch 5:  44%|████▍     | 4/9 [00:03<00:03,  1.26it/s, v_num=npzj]Epoch 5:  44%|████▍     | 4/9 [00:03<00:03,  1.26it/s, v_num=npzj]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.37it/s, v_num=npzj]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.37it/s, v_num=npzj]Epoch 5:  67%|██████▋   | 6/9 [00:04<00:02,  1.47it/s, v_num=npzj]Epoch 5:  67%|██████▋   | 6/9 [00:04<00:02,  1.47it/s, v_num=npzj]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.54it/s, v_num=npzj]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.54it/s, v_num=npzj]Epoch 5:  89%|████████▉ | 8/9 [00:05<00:00,  1.60it/s, v_num=npzj]Epoch 5:  89%|████████▉ | 8/9 [00:05<00:00,  1.60it/s, v_num=npzj]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.67it/s, v_num=npzj]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.67it/s, v_num=npzj]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.47it/s][A
                                                                      [AEpoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.31it/s, v_num=npzj]Epoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.30it/s, v_num=npzj]Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]        Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]Epoch 6:  11%|█         | 1/9 [00:01<00:13,  0.59it/s, v_num=npzj]Epoch 6:  11%|█         | 1/9 [00:01<00:13,  0.59it/s, v_num=npzj]Epoch 6:  22%|██▏       | 2/9 [00:02<00:07,  0.93it/s, v_num=npzj]Epoch 6:  22%|██▏       | 2/9 [00:02<00:07,  0.92it/s, v_num=npzj]Epoch 6:  33%|███▎      | 3/9 [00:02<00:05,  1.14it/s, v_num=npzj]Epoch 6:  33%|███▎      | 3/9 [00:02<00:05,  1.14it/s, v_num=npzj]Epoch 6:  44%|████▍     | 4/9 [00:03<00:03,  1.30it/s, v_num=npzj]Epoch 6:  44%|████▍     | 4/9 [00:03<00:03,  1.30it/s, v_num=npzj]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.41it/s, v_num=npzj]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.41it/s, v_num=npzj]Epoch 6:  67%|██████▋   | 6/9 [00:04<00:02,  1.49it/s, v_num=npzj]Epoch 6:  67%|██████▋   | 6/9 [00:04<00:02,  1.49it/s, v_num=npzj]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.56it/s, v_num=npzj]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.56it/s, v_num=npzj]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.62it/s, v_num=npzj]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.62it/s, v_num=npzj]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.69it/s, v_num=npzj]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.69it/s, v_num=npzj]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 62.25it/s][A
                                                                      [AEpoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=npzj]Epoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=npzj]Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]        Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]Epoch 7:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=npzj]Epoch 7:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=npzj]Epoch 7:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=npzj]Epoch 7:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=npzj]Epoch 7:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=npzj]Epoch 7:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=npzj]Epoch 7:  44%|████▍     | 4/9 [00:03<00:03,  1.32it/s, v_num=npzj]Epoch 7:  44%|████▍     | 4/9 [00:03<00:03,  1.31it/s, v_num=npzj]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=npzj]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=npzj]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.51it/s, v_num=npzj]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.51it/s, v_num=npzj]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=npzj]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=npzj]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.63it/s, v_num=npzj]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.63it/s, v_num=npzj]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=npzj]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=npzj]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 64.99it/s][A
Metric val_loss improved by 0.039 >= min_delta = 0.0. New best score: 0.600
                                                                      [AEpoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=npzj]Epoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.31it/s, v_num=npzj]Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]        Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]Epoch 8:  11%|█         | 1/9 [00:01<00:14,  0.57it/s, v_num=npzj]Epoch 8:  11%|█         | 1/9 [00:01<00:14,  0.57it/s, v_num=npzj]Epoch 8:  22%|██▏       | 2/9 [00:02<00:07,  0.90it/s, v_num=npzj]Epoch 8:  22%|██▏       | 2/9 [00:02<00:07,  0.90it/s, v_num=npzj]Epoch 8:  33%|███▎      | 3/9 [00:02<00:05,  1.12it/s, v_num=npzj]Epoch 8:  33%|███▎      | 3/9 [00:02<00:05,  1.12it/s, v_num=npzj]Epoch 8:  44%|████▍     | 4/9 [00:03<00:03,  1.27it/s, v_num=npzj]Epoch 8:  44%|████▍     | 4/9 [00:03<00:03,  1.27it/s, v_num=npzj]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.39it/s, v_num=npzj]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.39it/s, v_num=npzj]Epoch 8:  67%|██████▋   | 6/9 [00:04<00:02,  1.48it/s, v_num=npzj]Epoch 8:  67%|██████▋   | 6/9 [00:04<00:02,  1.48it/s, v_num=npzj]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.55it/s, v_num=npzj]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.55it/s, v_num=npzj]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.61it/s, v_num=npzj]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.61it/s, v_num=npzj]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.68it/s, v_num=npzj]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.68it/s, v_num=npzj]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 64.91it/s][A
                                                                      [AEpoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.30it/s, v_num=npzj]Epoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.30it/s, v_num=npzj]Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]        Epoch 9:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]Epoch 9:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=npzj]Epoch 9:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=npzj]Epoch 9:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=npzj]Epoch 9:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=npzj]Epoch 9:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=npzj]Epoch 9:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=npzj]Epoch 9:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=npzj]Epoch 9:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=npzj]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=npzj]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=npzj]Epoch 9:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=npzj]Epoch 9:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=npzj]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=npzj]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=npzj]Epoch 9:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=npzj]Epoch 9:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=npzj]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=npzj]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=npzj]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.90it/s][A
                                                                      [AEpoch 9: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=npzj]Epoch 9: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=npzj]Epoch 9:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]        Epoch 10:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]Epoch 10:  11%|█         | 1/9 [00:01<00:12,  0.62it/s, v_num=npzj]Epoch 10:  11%|█         | 1/9 [00:01<00:12,  0.62it/s, v_num=npzj]Epoch 10:  22%|██▏       | 2/9 [00:02<00:07,  0.96it/s, v_num=npzj]Epoch 10:  22%|██▏       | 2/9 [00:02<00:07,  0.96it/s, v_num=npzj]Epoch 10:  33%|███▎      | 3/9 [00:02<00:05,  1.19it/s, v_num=npzj]Epoch 10:  33%|███▎      | 3/9 [00:02<00:05,  1.19it/s, v_num=npzj]Epoch 10:  44%|████▍     | 4/9 [00:02<00:03,  1.34it/s, v_num=npzj]Epoch 10:  44%|████▍     | 4/9 [00:02<00:03,  1.34it/s, v_num=npzj]Epoch 10:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=npzj]Epoch 10:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=npzj]Epoch 10:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=npzj]Epoch 10:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=npzj]Epoch 10:  78%|███████▊  | 7/9 [00:04<00:01,  1.60it/s, v_num=npzj]Epoch 10:  78%|███████▊  | 7/9 [00:04<00:01,  1.60it/s, v_num=npzj]Epoch 10:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=npzj]Epoch 10:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=npzj]Epoch 10: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=npzj]Epoch 10: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=npzj]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 67.37it/s][A
                                                                      [AEpoch 10: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=npzj]Epoch 10: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=npzj]Epoch 10:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]        Epoch 11:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]Epoch 11:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=npzj]Epoch 11:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=npzj]Epoch 11:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=npzj]Epoch 11:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=npzj]Epoch 11:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=npzj]Epoch 11:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=npzj]Epoch 11:  44%|████▍     | 4/9 [00:03<00:03,  1.32it/s, v_num=npzj]Epoch 11:  44%|████▍     | 4/9 [00:03<00:03,  1.32it/s, v_num=npzj]Epoch 11:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=npzj]Epoch 11:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=npzj]Epoch 11:  67%|██████▋   | 6/9 [00:03<00:01,  1.52it/s, v_num=npzj]Epoch 11:  67%|██████▋   | 6/9 [00:03<00:01,  1.52it/s, v_num=npzj]Epoch 11:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=npzj]Epoch 11:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=npzj]Epoch 11:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=npzj]Epoch 11:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=npzj]Epoch 11: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=npzj]Epoch 11: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=npzj]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 64.84it/s][A
                                                                      [AEpoch 11: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=npzj]Epoch 11: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=npzj]Epoch 11:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]        Epoch 12:   0%|          | 0/9 [00:00<?, ?it/s, v_num=npzj]Epoch 12:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=npzj]Epoch 12:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=npzj]Epoch 12:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=npzj]Epoch 12:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=npzj]Epoch 12:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=npzj]Epoch 12:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=npzj]Epoch 12:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=npzj]Epoch 12:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=npzj]Epoch 12:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=npzj]Epoch 12:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=npzj]Epoch 12:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=npzj]Epoch 12:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=npzj]Epoch 12:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=npzj]Epoch 12:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=npzj]Epoch 12:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=npzj]Epoch 12:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=npzj]Epoch 12: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=npzj]Epoch 12: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=npzj]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 65.22it/s][A
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.600. Signaling Trainer to stop.
/home/ays124/mimic/venv/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
                                                                      [AEpoch 12: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=npzj]Epoch 12: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=npzj]Epoch 12: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=npzj]

VALIDATION for Fold 7
Test-loop:   0%|          | 0/1 [00:00<?, ?it/s]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.29s/it]
Cardiomegaly AUC: 0.6728

TESTING for Fold 7
Test-loop:   0%|          | 0/3 [00:00<?, ?it/s]Test-loop:  33%|███▎      | 1/3 [00:01<00:02,  1.14s/it]Test-loop:  67%|██████▋   | 2/3 [00:01<00:00,  1.77it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.66it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  1.98it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.019 MB of 0.026 MB uploaded (0.003 MB deduped)wandb: | 0.019 MB of 0.026 MB uploaded (0.003 MB deduped)wandb: / 0.030 MB of 0.030 MB uploaded (0.003 MB deduped)wandb:                                                                                
wandb: W&B sync reduced upload amount by 11.1%
wandb: 
wandb: Run history:
wandb:                         epoch ▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:               fold_7_test_auc ▁
wandb: fold_7_test_average precision ▁
wandb:                fold_7_test_f1 ▁
wandb:               fold_7_test_mcc ▁
wandb:               fold_7_test_npv ▁
wandb:               fold_7_test_ppv ▁
wandb:               fold_7_test_tnr ▁
wandb:               fold_7_test_tpr ▁
wandb:                fold_7_val_auc ▁
wandb:  fold_7_val_average precision ▁
wandb:                 fold_7_val_f1 ▁
wandb:                fold_7_val_mcc ▁
wandb:                fold_7_val_npv ▁
wandb:                fold_7_val_ppv ▁
wandb:                fold_7_val_tnr ▁
wandb:                fold_7_val_tpr ▁
wandb:                    train_loss ▆█▇▅▇▄▄▅▅█▄▅▃▄▂▆▃▄▅▁▅▁▂
wandb:           trainer/global_step ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▅▅▅▅▆▆▆▆▇▇▇▇██████████████
wandb:                      val_loss █▄▃▂▁▂▂▁▂▁▂▂▂
wandb: 
wandb: Run summary:
wandb:                         epoch 12
wandb:               fold_7_test_auc 0.58659
wandb: fold_7_test_average precision 0.75674
wandb:                fold_7_test_f1 0.79273
wandb:               fold_7_test_mcc 0.13668
wandb:               fold_7_test_npv 0.4382
wandb:               fold_7_test_ppv 0.72991
wandb:               fold_7_test_tnr 0.24375
wandb:               fold_7_test_tpr 0.86737
wandb:                fold_7_val_auc 0.67279
wandb:  fold_7_val_average precision 0.78843
wandb:                 fold_7_val_f1 0.79087
wandb:                fold_7_val_mcc 0.28816
wandb:                fold_7_val_npv 0.56522
wandb:                fold_7_val_ppv 0.7482
wandb:                fold_7_val_tnr 0.42623
wandb:                fold_7_val_tpr 0.83871
wandb:                    train_loss 0.48207
wandb:           trainer/global_step 116
wandb:                      val_loss 0.70496
wandb: 
wandb: 🚀 View run amber-wood-85 at: https://wandb.ai/chiragjp/mimic/runs/74i0npzj
wandb: ⭐️ View project at: https://wandb.ai/chiragjp/mimic
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./cardiomegaly/wandb/run-20240907_235322-74i0npzj/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/ays124/mimic/cardiomegaly/wandb/run-20240907_235505-gtlcbarq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run confused-resonance-86
wandb: ⭐️ View project at https://wandb.ai/chiragjp/mimic
wandb: 🚀 View run at https://wandb.ai/chiragjp/mimic/runs/gtlcbarq
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name  | Type     | Params | Mode 
-------------------------------------------
0 | model | DenseNet | 7.0 M  | train
-------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.820    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Cardiomegaly AUC: 0.5866

--- Fold 8/10 ---
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 46.49it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/9 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s] Epoch 0:  11%|█         | 1/9 [00:01<00:12,  0.65it/s]Epoch 0:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=barq]Epoch 0:  22%|██▏       | 2/9 [00:01<00:06,  1.04it/s, v_num=barq]Epoch 0:  22%|██▏       | 2/9 [00:01<00:06,  1.04it/s, v_num=barq]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.26it/s, v_num=barq]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.26it/s, v_num=barq]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.41it/s, v_num=barq]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.41it/s, v_num=barq]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.52it/s, v_num=barq]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.52it/s, v_num=barq]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.60it/s, v_num=barq]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.60it/s, v_num=barq]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.66it/s, v_num=barq]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.66it/s, v_num=barq]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=barq]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=barq]Epoch 0: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=barq]Epoch 0: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=barq]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 58.12it/s][A
Metric val_loss improved. New best score: 1.096
                                                                      [AEpoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=barq]Epoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=barq]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]        Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]Epoch 1:  11%|█         | 1/9 [00:01<00:13,  0.60it/s, v_num=barq]Epoch 1:  11%|█         | 1/9 [00:01<00:13,  0.60it/s, v_num=barq]Epoch 1:  22%|██▏       | 2/9 [00:02<00:07,  0.94it/s, v_num=barq]Epoch 1:  22%|██▏       | 2/9 [00:02<00:07,  0.94it/s, v_num=barq]Epoch 1:  33%|███▎      | 3/9 [00:02<00:05,  1.16it/s, v_num=barq]Epoch 1:  33%|███▎      | 3/9 [00:02<00:05,  1.16it/s, v_num=barq]Epoch 1:  44%|████▍     | 4/9 [00:03<00:03,  1.31it/s, v_num=barq]Epoch 1:  44%|████▍     | 4/9 [00:03<00:03,  1.31it/s, v_num=barq]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=barq]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=barq]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.51it/s, v_num=barq]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.51it/s, v_num=barq]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=barq]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=barq]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=barq]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=barq]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=barq]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=barq]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 62.49it/s][A
Metric val_loss improved by 0.469 >= min_delta = 0.0. New best score: 0.627
                                                                      [AEpoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=barq]Epoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=barq]Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]        Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=barq]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=barq]Epoch 2:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=barq]Epoch 2:  22%|██▏       | 2/9 [00:01<00:06,  1.00it/s, v_num=barq]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=barq]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=barq]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=barq]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=barq]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=barq]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=barq]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=barq]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=barq]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=barq]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=barq]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=barq]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=barq]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=barq]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=barq]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 65.53it/s][A
                                                                      [AEpoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=barq]Epoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=barq]Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]        Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]Epoch 3:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=barq]Epoch 3:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=barq]Epoch 3:  22%|██▏       | 2/9 [00:02<00:07,  0.97it/s, v_num=barq]Epoch 3:  22%|██▏       | 2/9 [00:02<00:07,  0.97it/s, v_num=barq]Epoch 3:  33%|███▎      | 3/9 [00:02<00:05,  1.19it/s, v_num=barq]Epoch 3:  33%|███▎      | 3/9 [00:02<00:05,  1.19it/s, v_num=barq]Epoch 3:  44%|████▍     | 4/9 [00:02<00:03,  1.34it/s, v_num=barq]Epoch 3:  44%|████▍     | 4/9 [00:02<00:03,  1.34it/s, v_num=barq]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=barq]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=barq]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=barq]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=barq]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.60it/s, v_num=barq]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.60it/s, v_num=barq]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=barq]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=barq]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=barq]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=barq]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 64.84it/s][A
Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.616
                                                                      [AEpoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=barq]Epoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=barq]Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]        Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]Epoch 4:  11%|█         | 1/9 [00:01<00:12,  0.62it/s, v_num=barq]Epoch 4:  11%|█         | 1/9 [00:01<00:12,  0.62it/s, v_num=barq]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.96it/s, v_num=barq]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.96it/s, v_num=barq]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.18it/s, v_num=barq]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.18it/s, v_num=barq]Epoch 4:  44%|████▍     | 4/9 [00:03<00:03,  1.33it/s, v_num=barq]Epoch 4:  44%|████▍     | 4/9 [00:03<00:03,  1.33it/s, v_num=barq]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.44it/s, v_num=barq]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.44it/s, v_num=barq]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=barq]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=barq]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=barq]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=barq]Epoch 4:  89%|████████▉ | 8/9 [00:05<00:00,  1.58it/s, v_num=barq]Epoch 4:  89%|████████▉ | 8/9 [00:05<00:00,  1.58it/s, v_num=barq]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=barq]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=barq]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 59.19it/s][A
                                                                      [AEpoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=barq]Epoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=barq]Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]        Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]Epoch 5:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=barq]Epoch 5:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=barq]Epoch 5:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=barq]Epoch 5:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=barq]Epoch 5:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=barq]Epoch 5:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=barq]Epoch 5:  44%|████▍     | 4/9 [00:03<00:03,  1.32it/s, v_num=barq]Epoch 5:  44%|████▍     | 4/9 [00:03<00:03,  1.32it/s, v_num=barq]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=barq]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=barq]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.52it/s, v_num=barq]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.52it/s, v_num=barq]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=barq]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=barq]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=barq]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.64it/s, v_num=barq]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=barq]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.71it/s, v_num=barq]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 57.40it/s][A
Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.592
                                                                      [AEpoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=barq]Epoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=barq]Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]        Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]Epoch 6:  11%|█         | 1/9 [00:01<00:11,  0.69it/s, v_num=barq]Epoch 6:  11%|█         | 1/9 [00:01<00:11,  0.69it/s, v_num=barq]Epoch 6:  22%|██▏       | 2/9 [00:01<00:06,  1.05it/s, v_num=barq]Epoch 6:  22%|██▏       | 2/9 [00:01<00:06,  1.05it/s, v_num=barq]Epoch 6:  33%|███▎      | 3/9 [00:02<00:04,  1.27it/s, v_num=barq]Epoch 6:  33%|███▎      | 3/9 [00:02<00:04,  1.27it/s, v_num=barq]Epoch 6:  44%|████▍     | 4/9 [00:02<00:03,  1.41it/s, v_num=barq]Epoch 6:  44%|████▍     | 4/9 [00:02<00:03,  1.41it/s, v_num=barq]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.52it/s, v_num=barq]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.52it/s, v_num=barq]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.60it/s, v_num=barq]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.60it/s, v_num=barq]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.66it/s, v_num=barq]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.66it/s, v_num=barq]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=barq]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=barq]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=barq]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=barq]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 56.85it/s][A
                                                                      [AEpoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=barq]Epoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=barq]Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]        Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]Epoch 7:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=barq]Epoch 7:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=barq]Epoch 7:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=barq]Epoch 7:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=barq]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=barq]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=barq]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=barq]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=barq]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=barq]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=barq]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=barq]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=barq]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=barq]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=barq]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=barq]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=barq]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=barq]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=barq]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 57.17it/s][A
                                                                      [AEpoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=barq]Epoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=barq]Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]        Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]Epoch 8:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=barq]Epoch 8:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=barq]Epoch 8:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=barq]Epoch 8:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=barq]Epoch 8:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=barq]Epoch 8:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=barq]Epoch 8:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=barq]Epoch 8:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=barq]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=barq]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=barq]Epoch 8:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=barq]Epoch 8:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=barq]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=barq]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=barq]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=barq]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=barq]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=barq]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=barq]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 58.84it/s][A
                                                                      [AEpoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=barq]Epoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=barq]Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]        Epoch 9:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]Epoch 9:  11%|█         | 1/9 [00:01<00:13,  0.59it/s, v_num=barq]Epoch 9:  11%|█         | 1/9 [00:01<00:13,  0.59it/s, v_num=barq]Epoch 9:  22%|██▏       | 2/9 [00:02<00:07,  0.93it/s, v_num=barq]Epoch 9:  22%|██▏       | 2/9 [00:02<00:07,  0.93it/s, v_num=barq]Epoch 9:  33%|███▎      | 3/9 [00:02<00:05,  1.15it/s, v_num=barq]Epoch 9:  33%|███▎      | 3/9 [00:02<00:05,  1.15it/s, v_num=barq]Epoch 9:  44%|████▍     | 4/9 [00:03<00:03,  1.30it/s, v_num=barq]Epoch 9:  44%|████▍     | 4/9 [00:03<00:03,  1.30it/s, v_num=barq]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.41it/s, v_num=barq]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.41it/s, v_num=barq]Epoch 9:  67%|██████▋   | 6/9 [00:03<00:01,  1.50it/s, v_num=barq]Epoch 9:  67%|██████▋   | 6/9 [00:03<00:01,  1.50it/s, v_num=barq]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.57it/s, v_num=barq]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.57it/s, v_num=barq]Epoch 9:  89%|████████▉ | 8/9 [00:04<00:00,  1.63it/s, v_num=barq]Epoch 9:  89%|████████▉ | 8/9 [00:04<00:00,  1.63it/s, v_num=barq]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.70it/s, v_num=barq]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.70it/s, v_num=barq]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 57.93it/s][A
                                                                      [AEpoch 9: 100%|██████████| 9/9 [00:06<00:00,  1.31it/s, v_num=barq]Epoch 9: 100%|██████████| 9/9 [00:06<00:00,  1.31it/s, v_num=barq]Epoch 9:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]        Epoch 10:   0%|          | 0/9 [00:00<?, ?it/s, v_num=barq]Epoch 10:  11%|█         | 1/9 [00:01<00:11,  0.72it/s, v_num=barq]Epoch 10:  11%|█         | 1/9 [00:01<00:11,  0.72it/s, v_num=barq]Epoch 10:  22%|██▏       | 2/9 [00:01<00:06,  1.08it/s, v_num=barq]Epoch 10:  22%|██▏       | 2/9 [00:01<00:06,  1.08it/s, v_num=barq]Epoch 10:  33%|███▎      | 3/9 [00:02<00:04,  1.30it/s, v_num=barq]Epoch 10:  33%|███▎      | 3/9 [00:02<00:04,  1.30it/s, v_num=barq]Epoch 10:  44%|████▍     | 4/9 [00:02<00:03,  1.43it/s, v_num=barq]Epoch 10:  44%|████▍     | 4/9 [00:02<00:03,  1.43it/s, v_num=barq]Epoch 10:  56%|█████▌    | 5/9 [00:03<00:02,  1.54it/s, v_num=barq]Epoch 10:  56%|█████▌    | 5/9 [00:03<00:02,  1.54it/s, v_num=barq]Epoch 10:  67%|██████▋   | 6/9 [00:03<00:01,  1.61it/s, v_num=barq]Epoch 10:  67%|██████▋   | 6/9 [00:03<00:01,  1.61it/s, v_num=barq]Epoch 10:  78%|███████▊  | 7/9 [00:04<00:01,  1.67it/s, v_num=barq]Epoch 10:  78%|███████▊  | 7/9 [00:04<00:01,  1.67it/s, v_num=barq]Epoch 10:  89%|████████▉ | 8/9 [00:04<00:00,  1.72it/s, v_num=barq]Epoch 10:  89%|████████▉ | 8/9 [00:04<00:00,  1.72it/s, v_num=barq]Epoch 10: 100%|██████████| 9/9 [00:05<00:00,  1.79it/s, v_num=barq]Epoch 10: 100%|██████████| 9/9 [00:05<00:00,  1.79it/s, v_num=barq]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 58.88it/s][A
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.592. Signaling Trainer to stop.
/home/ays124/mimic/venv/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
                                                                      [AEpoch 10: 100%|██████████| 9/9 [00:06<00:00,  1.40it/s, v_num=barq]Epoch 10: 100%|██████████| 9/9 [00:06<00:00,  1.40it/s, v_num=barq]Epoch 10: 100%|██████████| 9/9 [00:06<00:00,  1.40it/s, v_num=barq]

VALIDATION for Fold 8
Test-loop:   0%|          | 0/1 [00:00<?, ?it/s]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.17s/it]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.21s/it]
Cardiomegaly AUC: 0.6979

TESTING for Fold 8
Test-loop:   0%|          | 0/3 [00:00<?, ?it/s]Test-loop:  33%|███▎      | 1/3 [00:00<00:01,  1.11it/s]Test-loop:  67%|██████▋   | 2/3 [00:01<00:00,  2.13it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  3.04it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.33it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.019 MB of 0.026 MB uploaded (0.003 MB deduped)wandb: - 0.019 MB of 0.026 MB uploaded (0.003 MB deduped)wandb: \ 0.030 MB of 0.030 MB uploaded (0.003 MB deduped)wandb:                                                                                
wandb: W&B sync reduced upload amount by 11.2%
wandb: 
wandb: Run history:
wandb:                         epoch ▁▁▂▂▂▂▂▂▃▃▃▄▄▄▅▅▅▅▅▆▆▆▇▇▇▇▇▇██
wandb:               fold_8_test_auc ▁
wandb: fold_8_test_average precision ▁
wandb:                fold_8_test_f1 ▁
wandb:               fold_8_test_mcc ▁
wandb:               fold_8_test_npv ▁
wandb:               fold_8_test_ppv ▁
wandb:               fold_8_test_tnr ▁
wandb:               fold_8_test_tpr ▁
wandb:                fold_8_val_auc ▁
wandb:  fold_8_val_average precision ▁
wandb:                 fold_8_val_f1 ▁
wandb:                fold_8_val_mcc ▁
wandb:                fold_8_val_npv ▁
wandb:                fold_8_val_ppv ▁
wandb:                fold_8_val_tnr ▁
wandb:                fold_8_val_tpr ▁
wandb:                    train_loss █▅▅▅▆▇▄▄▅▅▆▃▁▇▅▄▂▃▄
wandb:           trainer/global_step ▁▁▁▂▂▂▂▃▃▃▄▄▄▄▅▅▅▅▆▆▇▇▇▇▇███████████████
wandb:                      val_loss █▁▃▁▂▁▁▁▃▃▁
wandb: 
wandb: Run summary:
wandb:                         epoch 10
wandb:               fold_8_test_auc 0.65444
wandb: fold_8_test_average precision 0.79942
wandb:                fold_8_test_f1 0.753
wandb:               fold_8_test_mcc 0.1839
wandb:               fold_8_test_npv 0.42424
wandb:               fold_8_test_ppv 0.75806
wandb:               fold_8_test_tnr 0.4375
wandb:               fold_8_test_tpr 0.74801
wandb:                fold_8_val_auc 0.69787
wandb:  fold_8_val_average precision 0.80357
wandb:                 fold_8_val_f1 0.81139
wandb:                fold_8_val_mcc 0.26533
wandb:                fold_8_val_npv 0.6
wandb:                fold_8_val_ppv 0.73548
wandb:                fold_8_val_tnr 0.30508
wandb:                fold_8_val_tpr 0.90476
wandb:                    train_loss 0.54395
wandb:           trainer/global_step 98
wandb:                      val_loss 0.61629
wandb: 
wandb: 🚀 View run confused-resonance-86 at: https://wandb.ai/chiragjp/mimic/runs/gtlcbarq
wandb: ⭐️ View project at: https://wandb.ai/chiragjp/mimic
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./cardiomegaly/wandb/run-20240907_235505-gtlcbarq/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/ays124/mimic/cardiomegaly/wandb/run-20240907_235634-y3vgb97d
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fragrant-moon-87
wandb: ⭐️ View project at https://wandb.ai/chiragjp/mimic
wandb: 🚀 View run at https://wandb.ai/chiragjp/mimic/runs/y3vgb97d
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name  | Type     | Params | Mode 
-------------------------------------------
0 | model | DenseNet | 7.0 M  | train
-------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.820    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Cardiomegaly AUC: 0.6544

--- Fold 9/10 ---
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 51.53it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/9 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s] Epoch 0:  11%|█         | 1/9 [00:01<00:10,  0.75it/s]Epoch 0:  11%|█         | 1/9 [00:01<00:10,  0.75it/s, v_num=b97d]Epoch 0:  22%|██▏       | 2/9 [00:01<00:05,  1.17it/s, v_num=b97d]Epoch 0:  22%|██▏       | 2/9 [00:01<00:06,  1.17it/s, v_num=b97d]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.37it/s, v_num=b97d]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.37it/s, v_num=b97d]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.51it/s, v_num=b97d]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.51it/s, v_num=b97d]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.61it/s, v_num=b97d]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.61it/s, v_num=b97d]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.68it/s, v_num=b97d]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.68it/s, v_num=b97d]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.73it/s, v_num=b97d]Epoch 0:  78%|███████▊  | 7/9 [00:04<00:01,  1.73it/s, v_num=b97d]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.78it/s, v_num=b97d]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.78it/s, v_num=b97d]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.84it/s, v_num=b97d]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.84it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 62.35it/s][A
Metric val_loss improved. New best score: 0.624
                                                                      [AEpoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.45it/s, v_num=b97d]Epoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.45it/s, v_num=b97d]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 1:  11%|█         | 1/9 [00:01<00:11,  0.72it/s, v_num=b97d]Epoch 1:  11%|█         | 1/9 [00:01<00:11,  0.72it/s, v_num=b97d]Epoch 1:  22%|██▏       | 2/9 [00:01<00:06,  1.08it/s, v_num=b97d]Epoch 1:  22%|██▏       | 2/9 [00:01<00:06,  1.08it/s, v_num=b97d]Epoch 1:  33%|███▎      | 3/9 [00:02<00:04,  1.30it/s, v_num=b97d]Epoch 1:  33%|███▎      | 3/9 [00:02<00:04,  1.30it/s, v_num=b97d]Epoch 1:  44%|████▍     | 4/9 [00:02<00:03,  1.44it/s, v_num=b97d]Epoch 1:  44%|████▍     | 4/9 [00:02<00:03,  1.44it/s, v_num=b97d]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.54it/s, v_num=b97d]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.54it/s, v_num=b97d]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.62it/s, v_num=b97d]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.62it/s, v_num=b97d]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.68it/s, v_num=b97d]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.68it/s, v_num=b97d]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.73it/s, v_num=b97d]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.73it/s, v_num=b97d]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.80it/s, v_num=b97d]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.80it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 64.00it/s][A
                                                                      [AEpoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.40it/s, v_num=b97d]Epoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.40it/s, v_num=b97d]Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=b97d]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=b97d]Epoch 2:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=b97d]Epoch 2:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=b97d]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=b97d]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=b97d]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.37it/s, v_num=b97d]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.37it/s, v_num=b97d]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=b97d]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=b97d]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.56it/s, v_num=b97d]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.56it/s, v_num=b97d]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=b97d]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=b97d]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=b97d]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=b97d]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=b97d]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 62.05it/s][A
Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.614
                                                                      [AEpoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.39it/s, v_num=b97d]Epoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=b97d]Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 3:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=b97d]Epoch 3:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=b97d]Epoch 3:  22%|██▏       | 2/9 [00:01<00:06,  1.02it/s, v_num=b97d]Epoch 3:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=b97d]Epoch 3:  33%|███▎      | 3/9 [00:02<00:04,  1.24it/s, v_num=b97d]Epoch 3:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=b97d]Epoch 3:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=b97d]Epoch 3:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=b97d]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=b97d]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=b97d]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=b97d]Epoch 3:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=b97d]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=b97d]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=b97d]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=b97d]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=b97d]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=b97d]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.08it/s][A
                                                                      [AEpoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=b97d]Epoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=b97d]Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 4:  11%|█         | 1/9 [00:01<00:13,  0.62it/s, v_num=b97d]Epoch 4:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=b97d]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.96it/s, v_num=b97d]Epoch 4:  22%|██▏       | 2/9 [00:02<00:07,  0.96it/s, v_num=b97d]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.18it/s, v_num=b97d]Epoch 4:  33%|███▎      | 3/9 [00:02<00:05,  1.18it/s, v_num=b97d]Epoch 4:  44%|████▍     | 4/9 [00:03<00:03,  1.33it/s, v_num=b97d]Epoch 4:  44%|████▍     | 4/9 [00:03<00:03,  1.33it/s, v_num=b97d]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=b97d]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.45it/s, v_num=b97d]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=b97d]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.53it/s, v_num=b97d]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.60it/s, v_num=b97d]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.60it/s, v_num=b97d]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=b97d]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=b97d]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=b97d]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 57.99it/s][A
Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.592
                                                                      [AEpoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=b97d]Epoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=b97d]Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 5:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=b97d]Epoch 5:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=b97d]Epoch 5:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=b97d]Epoch 5:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=b97d]Epoch 5:  33%|███▎      | 3/9 [00:02<00:05,  1.20it/s, v_num=b97d]Epoch 5:  33%|███▎      | 3/9 [00:02<00:05,  1.20it/s, v_num=b97d]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=b97d]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=b97d]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=b97d]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=b97d]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=b97d]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.54it/s, v_num=b97d]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=b97d]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=b97d]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=b97d]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.66it/s, v_num=b97d]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=b97d]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.73it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 65.34it/s][A
                                                                      [AEpoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=b97d]Epoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=b97d]Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 6:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=b97d]Epoch 6:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=b97d]Epoch 6:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=b97d]Epoch 6:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=b97d]Epoch 6:  33%|███▎      | 3/9 [00:02<00:05,  1.20it/s, v_num=b97d]Epoch 6:  33%|███▎      | 3/9 [00:02<00:05,  1.20it/s, v_num=b97d]Epoch 6:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=b97d]Epoch 6:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=b97d]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=b97d]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=b97d]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=b97d]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=b97d]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=b97d]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.61it/s, v_num=b97d]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=b97d]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=b97d]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=b97d]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.75it/s][A
                                                                      [AEpoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=b97d]Epoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=b97d]Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 7:  11%|█         | 1/9 [00:01<00:11,  0.70it/s, v_num=b97d]Epoch 7:  11%|█         | 1/9 [00:01<00:11,  0.70it/s, v_num=b97d]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.06it/s, v_num=b97d]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.06it/s, v_num=b97d]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.27it/s, v_num=b97d]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.27it/s, v_num=b97d]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.42it/s, v_num=b97d]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.42it/s, v_num=b97d]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.52it/s, v_num=b97d]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.52it/s, v_num=b97d]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.60it/s, v_num=b97d]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.60it/s, v_num=b97d]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.66it/s, v_num=b97d]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.66it/s, v_num=b97d]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=b97d]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=b97d]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=b97d]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 64.35it/s][A
Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.587
                                                                      [AEpoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=b97d]Epoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=b97d]Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 8:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=b97d]Epoch 8:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=b97d]Epoch 8:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=b97d]Epoch 8:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=b97d]Epoch 8:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=b97d]Epoch 8:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=b97d]Epoch 8:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=b97d]Epoch 8:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=b97d]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=b97d]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=b97d]Epoch 8:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=b97d]Epoch 8:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=b97d]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=b97d]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=b97d]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=b97d]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=b97d]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=b97d]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.13it/s][A
                                                                      [AEpoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=b97d]Epoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=b97d]Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 9:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 9:  11%|█         | 1/9 [00:01<00:11,  0.70it/s, v_num=b97d]Epoch 9:  11%|█         | 1/9 [00:01<00:11,  0.70it/s, v_num=b97d]Epoch 9:  22%|██▏       | 2/9 [00:01<00:06,  1.06it/s, v_num=b97d]Epoch 9:  22%|██▏       | 2/9 [00:01<00:06,  1.06it/s, v_num=b97d]Epoch 9:  33%|███▎      | 3/9 [00:02<00:04,  1.27it/s, v_num=b97d]Epoch 9:  33%|███▎      | 3/9 [00:02<00:04,  1.27it/s, v_num=b97d]Epoch 9:  44%|████▍     | 4/9 [00:02<00:03,  1.42it/s, v_num=b97d]Epoch 9:  44%|████▍     | 4/9 [00:02<00:03,  1.42it/s, v_num=b97d]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.52it/s, v_num=b97d]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.52it/s, v_num=b97d]Epoch 9:  67%|██████▋   | 6/9 [00:03<00:01,  1.60it/s, v_num=b97d]Epoch 9:  67%|██████▋   | 6/9 [00:03<00:01,  1.60it/s, v_num=b97d]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.67it/s, v_num=b97d]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.66it/s, v_num=b97d]Epoch 9:  89%|████████▉ | 8/9 [00:04<00:00,  1.72it/s, v_num=b97d]Epoch 9:  89%|████████▉ | 8/9 [00:04<00:00,  1.72it/s, v_num=b97d]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=b97d]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 62.97it/s][A
                                                                      [AEpoch 9: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=b97d]Epoch 9: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=b97d]Epoch 9:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 10:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 10:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=b97d]Epoch 10:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=b97d]Epoch 10:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=b97d]Epoch 10:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=b97d]Epoch 10:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=b97d]Epoch 10:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=b97d]Epoch 10:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=b97d]Epoch 10:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=b97d]Epoch 10:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=b97d]Epoch 10:  56%|█████▌    | 5/9 [00:03<00:02,  1.51it/s, v_num=b97d]Epoch 10:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=b97d]Epoch 10:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=b97d]Epoch 10:  78%|███████▊  | 7/9 [00:04<00:01,  1.66it/s, v_num=b97d]Epoch 10:  78%|███████▊  | 7/9 [00:04<00:01,  1.66it/s, v_num=b97d]Epoch 10:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=b97d]Epoch 10:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=b97d]Epoch 10: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=b97d]Epoch 10: 100%|██████████| 9/9 [00:05<00:00,  1.78it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 66.53it/s][A
                                                                      [AEpoch 10: 100%|██████████| 9/9 [00:06<00:00,  1.41it/s, v_num=b97d]Epoch 10: 100%|██████████| 9/9 [00:06<00:00,  1.40it/s, v_num=b97d]Epoch 10:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 11:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 11:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=b97d]Epoch 11:  11%|█         | 1/9 [00:01<00:12,  0.66it/s, v_num=b97d]Epoch 11:  22%|██▏       | 2/9 [00:02<00:07,  1.00it/s, v_num=b97d]Epoch 11:  22%|██▏       | 2/9 [00:02<00:07,  1.00it/s, v_num=b97d]Epoch 11:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=b97d]Epoch 11:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=b97d]Epoch 11:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=b97d]Epoch 11:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=b97d]Epoch 11:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=b97d]Epoch 11:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=b97d]Epoch 11:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=b97d]Epoch 11:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=b97d]Epoch 11:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=b97d]Epoch 11:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=b97d]Epoch 11:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=b97d]Epoch 11:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=b97d]Epoch 11: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=b97d]Epoch 11: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.59it/s][A
Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.581
                                                                      [AEpoch 11: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=b97d]Epoch 11: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=b97d]Epoch 11:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 12:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 12:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=b97d]Epoch 12:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=b97d]Epoch 12:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=b97d]Epoch 12:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=b97d]Epoch 12:  33%|███▎      | 3/9 [00:02<00:04,  1.24it/s, v_num=b97d]Epoch 12:  33%|███▎      | 3/9 [00:02<00:04,  1.24it/s, v_num=b97d]Epoch 12:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=b97d]Epoch 12:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=b97d]Epoch 12:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=b97d]Epoch 12:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=b97d]Epoch 12:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=b97d]Epoch 12:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=b97d]Epoch 12:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=b97d]Epoch 12:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=b97d]Epoch 12:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=b97d]Epoch 12:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=b97d]Epoch 12: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=b97d]Epoch 12: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.22it/s][A
                                                                      [AEpoch 12: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=b97d]Epoch 12: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=b97d]Epoch 12:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 13:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 13:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=b97d]Epoch 13:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=b97d]Epoch 13:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=b97d]Epoch 13:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=b97d]Epoch 13:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=b97d]Epoch 13:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=b97d]Epoch 13:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=b97d]Epoch 13:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=b97d]Epoch 13:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=b97d]Epoch 13:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=b97d]Epoch 13:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=b97d]Epoch 13:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=b97d]Epoch 13:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=b97d]Epoch 13:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=b97d]Epoch 13:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=b97d]Epoch 13:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=b97d]Epoch 13: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=b97d]Epoch 13: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 57.94it/s][A
                                                                      [AEpoch 13: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=b97d]Epoch 13: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=b97d]Epoch 13:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 14:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 14:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=b97d]Epoch 14:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=b97d]Epoch 14:  22%|██▏       | 2/9 [00:01<00:06,  1.02it/s, v_num=b97d]Epoch 14:  22%|██▏       | 2/9 [00:01<00:06,  1.02it/s, v_num=b97d]Epoch 14:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=b97d]Epoch 14:  33%|███▎      | 3/9 [00:02<00:04,  1.24it/s, v_num=b97d]Epoch 14:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=b97d]Epoch 14:  44%|████▍     | 4/9 [00:02<00:03,  1.40it/s, v_num=b97d]Epoch 14:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=b97d]Epoch 14:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=b97d]Epoch 14:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=b97d]Epoch 14:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=b97d]Epoch 14:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=b97d]Epoch 14:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=b97d]Epoch 14:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=b97d]Epoch 14:  89%|████████▉ | 8/9 [00:04<00:00,  1.70it/s, v_num=b97d]Epoch 14: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=b97d]Epoch 14: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 63.11it/s][A
                                                                      [AEpoch 14: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=b97d]Epoch 14: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=b97d]Epoch 14:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 15:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 15:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=b97d]Epoch 15:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=b97d]Epoch 15:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=b97d]Epoch 15:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=b97d]Epoch 15:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=b97d]Epoch 15:  33%|███▎      | 3/9 [00:02<00:05,  1.17it/s, v_num=b97d]Epoch 15:  44%|████▍     | 4/9 [00:03<00:03,  1.33it/s, v_num=b97d]Epoch 15:  44%|████▍     | 4/9 [00:03<00:03,  1.33it/s, v_num=b97d]Epoch 15:  56%|█████▌    | 5/9 [00:03<00:02,  1.44it/s, v_num=b97d]Epoch 15:  56%|█████▌    | 5/9 [00:03<00:02,  1.44it/s, v_num=b97d]Epoch 15:  67%|██████▋   | 6/9 [00:03<00:01,  1.52it/s, v_num=b97d]Epoch 15:  67%|██████▋   | 6/9 [00:03<00:01,  1.52it/s, v_num=b97d]Epoch 15:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=b97d]Epoch 15:  78%|███████▊  | 7/9 [00:04<00:01,  1.59it/s, v_num=b97d]Epoch 15:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=b97d]Epoch 15:  89%|████████▉ | 8/9 [00:04<00:00,  1.65it/s, v_num=b97d]Epoch 15: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=b97d]Epoch 15: 100%|██████████| 9/9 [00:05<00:00,  1.72it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 58.56it/s][A
                                                                      [AEpoch 15: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=b97d]Epoch 15: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=b97d]Epoch 15:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]        Epoch 16:   0%|          | 0/9 [00:00<?, ?it/s, v_num=b97d]Epoch 16:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=b97d]Epoch 16:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=b97d]Epoch 16:  22%|██▏       | 2/9 [00:02<00:07,  1.00it/s, v_num=b97d]Epoch 16:  22%|██▏       | 2/9 [00:02<00:07,  1.00it/s, v_num=b97d]Epoch 16:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=b97d]Epoch 16:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=b97d]Epoch 16:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=b97d]Epoch 16:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=b97d]Epoch 16:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=b97d]Epoch 16:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=b97d]Epoch 16:  67%|██████▋   | 6/9 [00:03<00:01,  1.56it/s, v_num=b97d]Epoch 16:  67%|██████▋   | 6/9 [00:03<00:01,  1.56it/s, v_num=b97d]Epoch 16:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=b97d]Epoch 16:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=b97d]Epoch 16:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=b97d]Epoch 16:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=b97d]Epoch 16: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=b97d]Epoch 16: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=b97d]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 59.82it/s][A
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.581. Signaling Trainer to stop.
/home/ays124/mimic/venv/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
                                                                      [AEpoch 16: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=b97d]Epoch 16: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=b97d]Epoch 16: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=b97d]

VALIDATION for Fold 9
Test-loop:   0%|          | 0/1 [00:00<?, ?it/s]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.31s/it]
Cardiomegaly AUC: 0.6633

TESTING for Fold 9
Test-loop:   0%|          | 0/3 [00:00<?, ?it/s]Test-loop:  33%|███▎      | 1/3 [00:00<00:01,  1.11it/s]Test-loop:  67%|██████▋   | 2/3 [00:01<00:00,  2.13it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  3.06it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.38it/s]
wandb: - 0.030 MB of 0.030 MB uploaded (0.003 MB deduped)wandb:                                                                                
wandb: W&B sync reduced upload amount by 11.1%
wandb: 
wandb: Run history:
wandb:                         epoch ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:               fold_9_test_auc ▁
wandb: fold_9_test_average precision ▁
wandb:                fold_9_test_f1 ▁
wandb:               fold_9_test_mcc ▁
wandb:               fold_9_test_npv ▁
wandb:               fold_9_test_ppv ▁
wandb:               fold_9_test_tnr ▁
wandb:               fold_9_test_tpr ▁
wandb:                fold_9_val_auc ▁
wandb:  fold_9_val_average precision ▁
wandb:                 fold_9_val_f1 ▁
wandb:                fold_9_val_mcc ▁
wandb:                fold_9_val_npv ▁
wandb:                fold_9_val_ppv ▁
wandb:                fold_9_val_tnr ▁
wandb:                fold_9_val_tpr ▁
wandb:                    train_loss ▄▇█▆▇█▅▆▆▆▅▄▅▅▅▇▆▅▆▄▆▅▄▃▅▂▄▃▁▃
wandb:           trainer/global_step ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇████████████
wandb:                      val_loss ▂▂▂▂▁▂▂▁▃▂▁▁▁▅▃▃█
wandb: 
wandb: Run summary:
wandb:                         epoch 16
wandb:               fold_9_test_auc 0.69208
wandb: fold_9_test_average precision 0.82145
wandb:                fold_9_test_f1 0.80649
wandb:               fold_9_test_mcc 0.25304
wandb:               fold_9_test_npv 0.52212
wandb:               fold_9_test_ppv 0.76179
wandb:               fold_9_test_tnr 0.36875
wandb:               fold_9_test_tpr 0.85676
wandb:                fold_9_val_auc 0.6633
wandb:  fold_9_val_average precision 0.81584
wandb:                 fold_9_val_f1 0.83333
wandb:                fold_9_val_mcc 0.18976
wandb:                fold_9_val_npv 0.52632
wandb:                fold_9_val_ppv 0.75301
wandb:                fold_9_val_tnr 0.19608
wandb:                fold_9_val_tpr 0.93284
wandb:                    train_loss 0.46154
wandb:           trainer/global_step 152
wandb:                      val_loss 0.90295
wandb: 
wandb: 🚀 View run fragrant-moon-87 at: https://wandb.ai/chiragjp/mimic/runs/y3vgb97d
wandb: ⭐️ View project at: https://wandb.ai/chiragjp/mimic
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./cardiomegaly/wandb/run-20240907_235634-y3vgb97d/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/ays124/mimic/cardiomegaly/wandb/run-20240907_235839-6zv3teml
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run likely-firebrand-88
wandb: ⭐️ View project at https://wandb.ai/chiragjp/mimic
wandb: 🚀 View run at https://wandb.ai/chiragjp/mimic/runs/6zv3teml
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name  | Type     | Params | Mode 
-------------------------------------------
0 | model | DenseNet | 7.0 M  | train
-------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.820    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Cardiomegaly AUC: 0.6921

--- Fold 10/10 ---
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 11.60it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/9 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s] Epoch 0:  11%|█         | 1/9 [00:01<00:10,  0.76it/s]Epoch 0:  11%|█         | 1/9 [00:01<00:10,  0.76it/s, v_num=teml]Epoch 0:  22%|██▏       | 2/9 [00:01<00:05,  1.18it/s, v_num=teml]Epoch 0:  22%|██▏       | 2/9 [00:01<00:05,  1.18it/s, v_num=teml]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.40it/s, v_num=teml]Epoch 0:  33%|███▎      | 3/9 [00:02<00:04,  1.39it/s, v_num=teml]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.53it/s, v_num=teml]Epoch 0:  44%|████▍     | 4/9 [00:02<00:03,  1.53it/s, v_num=teml]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.63it/s, v_num=teml]Epoch 0:  56%|█████▌    | 5/9 [00:03<00:02,  1.63it/s, v_num=teml]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.70it/s, v_num=teml]Epoch 0:  67%|██████▋   | 6/9 [00:03<00:01,  1.70it/s, v_num=teml]Epoch 0:  78%|███████▊  | 7/9 [00:03<00:01,  1.75it/s, v_num=teml]Epoch 0:  78%|███████▊  | 7/9 [00:03<00:01,  1.75it/s, v_num=teml]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.79it/s, v_num=teml]Epoch 0:  89%|████████▉ | 8/9 [00:04<00:00,  1.79it/s, v_num=teml]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.83it/s, v_num=teml]Epoch 0: 100%|██████████| 9/9 [00:04<00:00,  1.83it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 60.16it/s][A
Metric val_loss improved. New best score: 0.655
                                                                      [AEpoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.40it/s, v_num=teml]Epoch 0: 100%|██████████| 9/9 [00:06<00:00,  1.40it/s, v_num=teml]Epoch 0:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]        Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]Epoch 1:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=teml]Epoch 1:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=teml]Epoch 1:  22%|██▏       | 2/9 [00:02<00:07,  1.00it/s, v_num=teml]Epoch 1:  22%|██▏       | 2/9 [00:02<00:07,  1.00it/s, v_num=teml]Epoch 1:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=teml]Epoch 1:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=teml]Epoch 1:  44%|████▍     | 4/9 [00:02<00:03,  1.37it/s, v_num=teml]Epoch 1:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=teml]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=teml]Epoch 1:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=teml]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.56it/s, v_num=teml]Epoch 1:  67%|██████▋   | 6/9 [00:03<00:01,  1.56it/s, v_num=teml]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=teml]Epoch 1:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=teml]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=teml]Epoch 1:  89%|████████▉ | 8/9 [00:04<00:00,  1.68it/s, v_num=teml]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=teml]Epoch 1: 100%|██████████| 9/9 [00:05<00:00,  1.75it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.02it/s][A
Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.629
                                                                      [AEpoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.33it/s, v_num=teml]Epoch 1: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=teml]Epoch 1:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]        Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=teml]Epoch 2:  11%|█         | 1/9 [00:01<00:12,  0.64it/s, v_num=teml]Epoch 2:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=teml]Epoch 2:  22%|██▏       | 2/9 [00:02<00:07,  0.99it/s, v_num=teml]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=teml]Epoch 2:  33%|███▎      | 3/9 [00:02<00:04,  1.21it/s, v_num=teml]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=teml]Epoch 2:  44%|████▍     | 4/9 [00:02<00:03,  1.36it/s, v_num=teml]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=teml]Epoch 2:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=teml]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=teml]Epoch 2:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=teml]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=teml]Epoch 2:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=teml]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=teml]Epoch 2:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=teml]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=teml]Epoch 2: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 56.80it/s][A
                                                                      [AEpoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=teml]Epoch 2: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s, v_num=teml]Epoch 2:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]        Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]Epoch 3:  11%|█         | 1/9 [00:01<00:13,  0.57it/s, v_num=teml]Epoch 3:  11%|█         | 1/9 [00:01<00:13,  0.57it/s, v_num=teml]Epoch 3:  22%|██▏       | 2/9 [00:02<00:07,  0.91it/s, v_num=teml]Epoch 3:  22%|██▏       | 2/9 [00:02<00:07,  0.91it/s, v_num=teml]Epoch 3:  33%|███▎      | 3/9 [00:02<00:05,  1.13it/s, v_num=teml]Epoch 3:  33%|███▎      | 3/9 [00:02<00:05,  1.12it/s, v_num=teml]Epoch 3:  44%|████▍     | 4/9 [00:03<00:03,  1.27it/s, v_num=teml]Epoch 3:  44%|████▍     | 4/9 [00:03<00:03,  1.27it/s, v_num=teml]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.39it/s, v_num=teml]Epoch 3:  56%|█████▌    | 5/9 [00:03<00:02,  1.39it/s, v_num=teml]Epoch 3:  67%|██████▋   | 6/9 [00:04<00:02,  1.47it/s, v_num=teml]Epoch 3:  67%|██████▋   | 6/9 [00:04<00:02,  1.47it/s, v_num=teml]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.54it/s, v_num=teml]Epoch 3:  78%|███████▊  | 7/9 [00:04<00:01,  1.54it/s, v_num=teml]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.60it/s, v_num=teml]Epoch 3:  89%|████████▉ | 8/9 [00:04<00:00,  1.60it/s, v_num=teml]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.67it/s, v_num=teml]Epoch 3: 100%|██████████| 9/9 [00:05<00:00,  1.67it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 61.44it/s][A
Metric val_loss improved by 0.042 >= min_delta = 0.0. New best score: 0.586
                                                                      [AEpoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.31it/s, v_num=teml]Epoch 3: 100%|██████████| 9/9 [00:06<00:00,  1.30it/s, v_num=teml]Epoch 3:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]        Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]Epoch 4:  11%|█         | 1/9 [00:01<00:11,  0.68it/s, v_num=teml]Epoch 4:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=teml]Epoch 4:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=teml]Epoch 4:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=teml]Epoch 4:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=teml]Epoch 4:  33%|███▎      | 3/9 [00:02<00:04,  1.25it/s, v_num=teml]Epoch 4:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=teml]Epoch 4:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=teml]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=teml]Epoch 4:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=teml]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=teml]Epoch 4:  67%|██████▋   | 6/9 [00:03<00:01,  1.58it/s, v_num=teml]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=teml]Epoch 4:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=teml]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=teml]Epoch 4:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=teml]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=teml]Epoch 4: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 55.06it/s][A
                                                                      [AEpoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.31it/s, v_num=teml]Epoch 4: 100%|██████████| 9/9 [00:06<00:00,  1.31it/s, v_num=teml]Epoch 4:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]        Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]Epoch 5:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=teml]Epoch 5:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=teml]Epoch 5:  22%|██▏       | 2/9 [00:01<00:06,  1.00it/s, v_num=teml]Epoch 5:  22%|██▏       | 2/9 [00:01<00:06,  1.00it/s, v_num=teml]Epoch 5:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=teml]Epoch 5:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=teml]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=teml]Epoch 5:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=teml]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=teml]Epoch 5:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=teml]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=teml]Epoch 5:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=teml]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=teml]Epoch 5:  78%|███████▊  | 7/9 [00:04<00:01,  1.64it/s, v_num=teml]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=teml]Epoch 5:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=teml]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=teml]Epoch 5: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 59.84it/s][A
                                                                      [AEpoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=teml]Epoch 5: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=teml]Epoch 5:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]        Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]Epoch 6:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=teml]Epoch 6:  11%|█         | 1/9 [00:01<00:12,  0.63it/s, v_num=teml]Epoch 6:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=teml]Epoch 6:  22%|██▏       | 2/9 [00:02<00:07,  0.98it/s, v_num=teml]Epoch 6:  33%|███▎      | 3/9 [00:02<00:05,  1.20it/s, v_num=teml]Epoch 6:  33%|███▎      | 3/9 [00:02<00:05,  1.20it/s, v_num=teml]Epoch 6:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=teml]Epoch 6:  44%|████▍     | 4/9 [00:02<00:03,  1.35it/s, v_num=teml]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s, v_num=teml]Epoch 6:  56%|█████▌    | 5/9 [00:03<00:02,  1.46it/s, v_num=teml]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=teml]Epoch 6:  67%|██████▋   | 6/9 [00:03<00:01,  1.55it/s, v_num=teml]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=teml]Epoch 6:  78%|███████▊  | 7/9 [00:04<00:01,  1.62it/s, v_num=teml]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=teml]Epoch 6:  89%|████████▉ | 8/9 [00:04<00:00,  1.67it/s, v_num=teml]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=teml]Epoch 6: 100%|██████████| 9/9 [00:05<00:00,  1.74it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 67.62it/s][A
                                                                      [AEpoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=teml]Epoch 6: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=teml]Epoch 6:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]        Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]Epoch 7:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=teml]Epoch 7:  11%|█         | 1/9 [00:01<00:12,  0.65it/s, v_num=teml]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=teml]Epoch 7:  22%|██▏       | 2/9 [00:01<00:06,  1.01it/s, v_num=teml]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=teml]Epoch 7:  33%|███▎      | 3/9 [00:02<00:04,  1.22it/s, v_num=teml]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=teml]Epoch 7:  44%|████▍     | 4/9 [00:02<00:03,  1.37it/s, v_num=teml]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=teml]Epoch 7:  56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s, v_num=teml]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=teml]Epoch 7:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=teml]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=teml]Epoch 7:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=teml]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=teml]Epoch 7:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=teml]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=teml]Epoch 7: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 60.42it/s][A
                                                                      [AEpoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.37it/s, v_num=teml]Epoch 7: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=teml]Epoch 7:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]        Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]Epoch 8:  11%|█         | 1/9 [00:01<00:13,  0.57it/s, v_num=teml]Epoch 8:  11%|█         | 1/9 [00:01<00:13,  0.57it/s, v_num=teml]Epoch 8:  22%|██▏       | 2/9 [00:02<00:07,  0.91it/s, v_num=teml]Epoch 8:  22%|██▏       | 2/9 [00:02<00:07,  0.91it/s, v_num=teml]Epoch 8:  33%|███▎      | 3/9 [00:02<00:05,  1.13it/s, v_num=teml]Epoch 8:  33%|███▎      | 3/9 [00:02<00:05,  1.13it/s, v_num=teml]Epoch 8:  44%|████▍     | 4/9 [00:03<00:03,  1.28it/s, v_num=teml]Epoch 8:  44%|████▍     | 4/9 [00:03<00:03,  1.28it/s, v_num=teml]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.40it/s, v_num=teml]Epoch 8:  56%|█████▌    | 5/9 [00:03<00:02,  1.40it/s, v_num=teml]Epoch 8:  67%|██████▋   | 6/9 [00:04<00:02,  1.49it/s, v_num=teml]Epoch 8:  67%|██████▋   | 6/9 [00:04<00:02,  1.49it/s, v_num=teml]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.56it/s, v_num=teml]Epoch 8:  78%|███████▊  | 7/9 [00:04<00:01,  1.56it/s, v_num=teml]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.61it/s, v_num=teml]Epoch 8:  89%|████████▉ | 8/9 [00:04<00:00,  1.61it/s, v_num=teml]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.68it/s, v_num=teml]Epoch 8: 100%|██████████| 9/9 [00:05<00:00,  1.68it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 45.21it/s][A
Metric val_loss improved by 0.034 >= min_delta = 0.0. New best score: 0.552
                                                                      [AEpoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.29it/s, v_num=teml]Epoch 8: 100%|██████████| 9/9 [00:06<00:00,  1.29it/s, v_num=teml]Epoch 8:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]        Epoch 9:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]Epoch 9:  11%|█         | 1/9 [00:01<00:14,  0.57it/s, v_num=teml]Epoch 9:  11%|█         | 1/9 [00:01<00:14,  0.57it/s, v_num=teml]Epoch 9:  22%|██▏       | 2/9 [00:02<00:07,  0.90it/s, v_num=teml]Epoch 9:  22%|██▏       | 2/9 [00:02<00:07,  0.90it/s, v_num=teml]Epoch 9:  33%|███▎      | 3/9 [00:02<00:05,  1.11it/s, v_num=teml]Epoch 9:  33%|███▎      | 3/9 [00:02<00:05,  1.11it/s, v_num=teml]Epoch 9:  44%|████▍     | 4/9 [00:03<00:03,  1.27it/s, v_num=teml]Epoch 9:  44%|████▍     | 4/9 [00:03<00:03,  1.27it/s, v_num=teml]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.38it/s, v_num=teml]Epoch 9:  56%|█████▌    | 5/9 [00:03<00:02,  1.38it/s, v_num=teml]Epoch 9:  67%|██████▋   | 6/9 [00:04<00:02,  1.47it/s, v_num=teml]Epoch 9:  67%|██████▋   | 6/9 [00:04<00:02,  1.47it/s, v_num=teml]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.54it/s, v_num=teml]Epoch 9:  78%|███████▊  | 7/9 [00:04<00:01,  1.54it/s, v_num=teml]Epoch 9:  89%|████████▉ | 8/9 [00:05<00:00,  1.60it/s, v_num=teml]Epoch 9:  89%|████████▉ | 8/9 [00:05<00:00,  1.60it/s, v_num=teml]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.67it/s, v_num=teml]Epoch 9: 100%|██████████| 9/9 [00:05<00:00,  1.67it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 56.67it/s][A
                                                                      [AEpoch 9: 100%|██████████| 9/9 [00:07<00:00,  1.26it/s, v_num=teml]Epoch 9: 100%|██████████| 9/9 [00:07<00:00,  1.26it/s, v_num=teml]Epoch 9:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]        Epoch 10:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]Epoch 10:  11%|█         | 1/9 [00:01<00:13,  0.58it/s, v_num=teml]Epoch 10:  11%|█         | 1/9 [00:01<00:13,  0.58it/s, v_num=teml]Epoch 10:  22%|██▏       | 2/9 [00:02<00:07,  0.91it/s, v_num=teml]Epoch 10:  22%|██▏       | 2/9 [00:02<00:07,  0.91it/s, v_num=teml]Epoch 10:  33%|███▎      | 3/9 [00:02<00:05,  1.13it/s, v_num=teml]Epoch 10:  33%|███▎      | 3/9 [00:02<00:05,  1.13it/s, v_num=teml]Epoch 10:  44%|████▍     | 4/9 [00:03<00:03,  1.28it/s, v_num=teml]Epoch 10:  44%|████▍     | 4/9 [00:03<00:03,  1.28it/s, v_num=teml]Epoch 10:  56%|█████▌    | 5/9 [00:03<00:02,  1.40it/s, v_num=teml]Epoch 10:  56%|█████▌    | 5/9 [00:03<00:02,  1.40it/s, v_num=teml]Epoch 10:  67%|██████▋   | 6/9 [00:04<00:02,  1.48it/s, v_num=teml]Epoch 10:  67%|██████▋   | 6/9 [00:04<00:02,  1.48it/s, v_num=teml]Epoch 10:  78%|███████▊  | 7/9 [00:04<00:01,  1.55it/s, v_num=teml]Epoch 10:  78%|███████▊  | 7/9 [00:04<00:01,  1.55it/s, v_num=teml]Epoch 10:  89%|████████▉ | 8/9 [00:04<00:00,  1.61it/s, v_num=teml]Epoch 10:  89%|████████▉ | 8/9 [00:04<00:00,  1.61it/s, v_num=teml]Epoch 10: 100%|██████████| 9/9 [00:05<00:00,  1.68it/s, v_num=teml]Epoch 10: 100%|██████████| 9/9 [00:05<00:00,  1.68it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 59.81it/s][A
                                                                      [AEpoch 10: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=teml]Epoch 10: 100%|██████████| 9/9 [00:06<00:00,  1.34it/s, v_num=teml]Epoch 10:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]        Epoch 11:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]Epoch 11:  11%|█         | 1/9 [00:01<00:12,  0.67it/s, v_num=teml]Epoch 11:  11%|█         | 1/9 [00:01<00:12,  0.67it/s, v_num=teml]Epoch 11:  22%|██▏       | 2/9 [00:01<00:06,  1.02it/s, v_num=teml]Epoch 11:  22%|██▏       | 2/9 [00:01<00:06,  1.02it/s, v_num=teml]Epoch 11:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=teml]Epoch 11:  33%|███▎      | 3/9 [00:02<00:04,  1.23it/s, v_num=teml]Epoch 11:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=teml]Epoch 11:  44%|████▍     | 4/9 [00:02<00:03,  1.38it/s, v_num=teml]Epoch 11:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=teml]Epoch 11:  56%|█████▌    | 5/9 [00:03<00:02,  1.49it/s, v_num=teml]Epoch 11:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=teml]Epoch 11:  67%|██████▋   | 6/9 [00:03<00:01,  1.57it/s, v_num=teml]Epoch 11:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=teml]Epoch 11:  78%|███████▊  | 7/9 [00:04<00:01,  1.63it/s, v_num=teml]Epoch 11:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=teml]Epoch 11:  89%|████████▉ | 8/9 [00:04<00:00,  1.69it/s, v_num=teml]Epoch 11: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=teml]Epoch 11: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 64.26it/s][A
                                                                      [AEpoch 11: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=teml]Epoch 11: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s, v_num=teml]Epoch 11:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]        Epoch 12:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]Epoch 12:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=teml]Epoch 12:  11%|█         | 1/9 [00:01<00:11,  0.67it/s, v_num=teml]Epoch 12:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=teml]Epoch 12:  22%|██▏       | 2/9 [00:01<00:06,  1.03it/s, v_num=teml]Epoch 12:  33%|███▎      | 3/9 [00:02<00:04,  1.24it/s, v_num=teml]Epoch 12:  33%|███▎      | 3/9 [00:02<00:04,  1.24it/s, v_num=teml]Epoch 12:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=teml]Epoch 12:  44%|████▍     | 4/9 [00:02<00:03,  1.39it/s, v_num=teml]Epoch 12:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=teml]Epoch 12:  56%|█████▌    | 5/9 [00:03<00:02,  1.50it/s, v_num=teml]Epoch 12:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=teml]Epoch 12:  67%|██████▋   | 6/9 [00:03<00:01,  1.59it/s, v_num=teml]Epoch 12:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=teml]Epoch 12:  78%|███████▊  | 7/9 [00:04<00:01,  1.65it/s, v_num=teml]Epoch 12:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=teml]Epoch 12:  89%|████████▉ | 8/9 [00:04<00:00,  1.71it/s, v_num=teml]Epoch 12: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=teml]Epoch 12: 100%|██████████| 9/9 [00:05<00:00,  1.77it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 63.99it/s][A
                                                                      [AEpoch 12: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=teml]Epoch 12: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s, v_num=teml]Epoch 12:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]        Epoch 13:   0%|          | 0/9 [00:00<?, ?it/s, v_num=teml]Epoch 13:  11%|█         | 1/9 [00:01<00:13,  0.61it/s, v_num=teml]Epoch 13:  11%|█         | 1/9 [00:01<00:13,  0.60it/s, v_num=teml]Epoch 13:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=teml]Epoch 13:  22%|██▏       | 2/9 [00:02<00:07,  0.95it/s, v_num=teml]Epoch 13:  33%|███▎      | 3/9 [00:02<00:05,  1.16it/s, v_num=teml]Epoch 13:  33%|███▎      | 3/9 [00:02<00:05,  1.16it/s, v_num=teml]Epoch 13:  44%|████▍     | 4/9 [00:03<00:03,  1.31it/s, v_num=teml]Epoch 13:  44%|████▍     | 4/9 [00:03<00:03,  1.31it/s, v_num=teml]Epoch 13:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=teml]Epoch 13:  56%|█████▌    | 5/9 [00:03<00:02,  1.43it/s, v_num=teml]Epoch 13:  67%|██████▋   | 6/9 [00:03<00:01,  1.51it/s, v_num=teml]Epoch 13:  67%|██████▋   | 6/9 [00:03<00:01,  1.51it/s, v_num=teml]Epoch 13:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=teml]Epoch 13:  78%|███████▊  | 7/9 [00:04<00:01,  1.58it/s, v_num=teml]Epoch 13:  89%|████████▉ | 8/9 [00:04<00:00,  1.63it/s, v_num=teml]Epoch 13:  89%|████████▉ | 8/9 [00:04<00:00,  1.63it/s, v_num=teml]Epoch 13: 100%|██████████| 9/9 [00:05<00:00,  1.70it/s, v_num=teml]Epoch 13: 100%|██████████| 9/9 [00:05<00:00,  1.70it/s, v_num=teml]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 64.06it/s][A
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.552. Signaling Trainer to stop.
/home/ays124/mimic/venv/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ays124/mimic/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
                                                                      [AEpoch 13: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=teml]Epoch 13: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=teml]Epoch 13: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s, v_num=teml]

VALIDATION for Fold 10
Test-loop:   0%|          | 0/1 [00:00<?, ?it/s]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it]Test-loop: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it]
Cardiomegaly AUC: 0.7040

TESTING for Fold 10
Test-loop:   0%|          | 0/3 [00:00<?, ?it/s]Test-loop:  33%|███▎      | 1/3 [00:00<00:01,  1.01it/s]Test-loop:  67%|██████▋   | 2/3 [00:01<00:00,  2.00it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.93it/s]Test-loop: 100%|██████████| 3/3 [00:01<00:00,  2.21it/s]
wandb: - 0.030 MB of 0.030 MB uploaded (0.003 MB deduped)wandb:                                                                                
wandb: W&B sync reduced upload amount by 11.2%
wandb: 
wandb: Run history:
wandb:                          epoch ▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:               fold_10_test_auc ▁
wandb: fold_10_test_average precision ▁
wandb:                fold_10_test_f1 ▁
wandb:               fold_10_test_mcc ▁
wandb:               fold_10_test_npv ▁
wandb:               fold_10_test_ppv ▁
wandb:               fold_10_test_tnr ▁
wandb:               fold_10_test_tpr ▁
wandb:                fold_10_val_auc ▁
wandb:  fold_10_val_average precision ▁
wandb:                 fold_10_val_f1 ▁
wandb:                fold_10_val_mcc ▁
wandb:                fold_10_val_npv ▁
wandb:                fold_10_val_ppv ▁
wandb:                fold_10_val_tnr ▁
wandb:                fold_10_val_tpr ▁
wandb:                     train_loss █▄▇▆▅▅▆▄▄▄▅▆▃▅▆▅▄▃▅▃▄▁▂▁▂
wandb:            trainer/global_step ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▆▆▆▆▇▇▇██████████████
wandb:                       val_loss ▅▄▆▂▃▆▄▃▁▆█▄▆▅
wandb: 
wandb: Run summary:
wandb:                          epoch 13
wandb:               fold_10_test_auc 0.67185
wandb: fold_10_test_average precision 0.82704
wandb:                fold_10_test_f1 0.82051
wandb:               fold_10_test_mcc 0.1907
wandb:               fold_10_test_npv 0.55357
wandb:               fold_10_test_ppv 0.73181
wandb:               fold_10_test_tnr 0.19375
wandb:               fold_10_test_tpr 0.93369
wandb:                fold_10_val_auc 0.70402
wandb:  fold_10_val_average precision 0.80793
wandb:                 fold_10_val_f1 0.83612
wandb:                fold_10_val_mcc 0.22963
wandb:                fold_10_val_npv 0.625
wandb:                fold_10_val_ppv 0.74405
wandb:                fold_10_val_tnr 0.18868
wandb:                fold_10_val_tpr 0.9542
wandb:                     train_loss 0.43929
wandb:            trainer/global_step 125
wandb:                       val_loss 0.65896
wandb: 
wandb: 🚀 View run likely-firebrand-88 at: https://wandb.ai/chiragjp/mimic/runs/6zv3teml
wandb: ⭐️ View project at: https://wandb.ai/chiragjp/mimic
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./cardiomegaly/wandb/run-20240907_235839-6zv3teml/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
Cardiomegaly AUC: 0.6719

Mean Validation Metrics across 10 folds: {'AUC': np.float64(0.6595208859004728), 'Average Precision': np.float64(0.8013552215326427), 'TPR': np.float64(0.9121865978209905), 'TNR': np.float64(0.2264805306467021), 'PPV': np.float64(0.7327315282377942), 'NPV': np.float64(0.4968264782509634), 'F1': np.float64(0.8116300843388766), 'MCC': np.float64(0.18520010692650338)}

Mean Test Metrics across 10 folds: {'AUC': np.float64(0.6617871352785147), 'Average Precision': np.float64(0.811636805487083), 'TPR': np.float64(0.8657824933687003), 'TNR': np.float64(0.28125), 'PPV': np.float64(0.7416661875618716), 'NPV': np.float64(0.42977045328829516), 'F1': np.float64(0.79656856639743), 'MCC': np.float64(0.17045885100094785)}

Best folds based on validation metrics: {'AUC': 1, 'Average Precision': 2, 'TPR': 4, 'TNR': 7, 'PPV': 4, 'NPV': 1, 'F1': 4, 'MCC': 1}
